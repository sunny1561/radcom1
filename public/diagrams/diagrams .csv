figure,desc,
Figure 4.2.1-1: UE state machine and state transitions in NR,"-
 RRC_IDLE:
ETSI
3GPP TS 38.331 version 15.7.0 Release 15
 21
 ETSI TS 138 331 V15.7.0 (2019-10)
-
 A UE specific DRX may be configured by upper layers;
-
 UE controlled mobility based on network configuration;
-
 The UE:
-
 Monitors Short Messages transmitted with P-RNTI over DCI (see clause 6.5);
-
 Monitors a Paging channel for CN paging using 5G-S-TMSI;
-
 Performs neighbouring cell measurements and cell (re-)selection;
-
 Acquires system information and can send SI request (if configured).
-
 RRC_INACTIVE:
-
 A UE specific DRX may be configured by upper layers or by RRC layer;
-
 UE controlled mobility based on network configuration;
-
 The UE stores the UE Inactive AS context;
-
 A RAN-based notification area is configured by RRC layer;
The UE:
-
 Monitors Short Messages transmitted with P-RNTI over DCI (see clause 6.5);
-
 Monitors a Paging channel for CN paging using 5G-S-TMSI and RAN paging using fullI-RNTI;
-
 Performs neighbouring cell measurements and cell (re-)selection;
-
 Performs RAN-based notification area updates periodically and when moving outside the configured
RAN-based notification area;
-
 Acquires system information and can send SI request (if configured).
-
 RRC_CONNECTED:
-
 The UE stores the AS context;
-
 Transfer of unicast data to/from UE;
-
 At lower layers, the UE may be configured with a UE specific DRX;
-
 For UEs supporting CA, use of one or more SCells, aggregated with the SpCell, for increased bandwidth;
-
 For UEs supporting DC, use of one SCG, aggregated with the MCG, for increased bandwidth;
-
 Network controlled mobility within NR and to/from E-UTRA;
-
 The UE:
-
 Monitors Short Messages transmitted with P-RNTI over DCI (see clause 6.5), if configured;
-
 Monitors control channels associated with the shared data channel to determine if data is scheduled for it;
-
 Provides channel quality and feedback information;
-
 Performs neighbouring cell measurements and measurement reporting;
-
 Acquires system information.
Figure 4.2.1-1 illustrates an overview of UE RRC state machine and state transitions in NR. A UE has only one RRC
state in NR at one time.",1.png
"Figure 4.2.1-2: UE state machine and state transitions between NR/5GC, E-UTRA/EPC and E- UTRA/5GC","illustrates an overview of UE state machine and state transitions in NR as well as the mobility procedures
supported between NR/5GC E-UTRA/EPC and E-UTRA/5GC.-
 RRC_IDLE:
ETSI
3GPP TS 38.331 version 15.7.0 Release 15
 21
 ETSI TS 138 331 V15.7.0 (2019-10)
-
 A UE specific DRX may be configured by upper layers;
-
 UE controlled mobility based on network configuration;
-
 The UE:
-
 Monitors Short Messages transmitted with P-RNTI over DCI (see clause 6.5);
-
 Monitors a Paging channel for CN paging using 5G-S-TMSI;
-
 Performs neighbouring cell measurements and cell (re-)selection;
-
 Acquires system information and can send SI request (if configured).
-
 RRC_INACTIVE:
-
 A UE specific DRX may be configured by upper layers or by RRC layer;
-
 UE controlled mobility based on network configuration;
-
 The UE stores the UE Inactive AS context;
-
 A RAN-based notification area is configured by RRC layer;
The UE:
-
 Monitors Short Messages transmitted with P-RNTI over DCI (see clause 6.5);
-
 Monitors a Paging channel for CN paging using 5G-S-TMSI and RAN paging using fullI-RNTI;
-
 Performs neighbouring cell measurements and cell (re-)selection;
-
 Performs RAN-based notification area updates periodically and when moving outside the configured
RAN-based notification area;
-
 Acquires system information and can send SI request (if configured).
-
 RRC_CONNECTED:
-
 The UE stores the AS context;
-
 Transfer of unicast data to/from UE;
-
 At lower layers, the UE may be configured with a UE specific DRX;
-
 For UEs supporting CA, use of one or more SCells, aggregated with the SpCell, for increased bandwidth;
-
 For UEs supporting DC, use of one SCG, aggregated with the MCG, for increased bandwidth;
-
 Network controlled mobility within NR and to/from E-UTRA;
-
 The UE:
-
 Monitors Short Messages transmitted with P-RNTI over DCI (see clause 6.5), if configured;
-
 Monitors control channels associated with the shared data channel to determine if data is scheduled for it;
-
 Provides channel quality and feedback information;
-
 Performs neighbouring cell measurements and measurement reporting;
-
 Acquires system information.
Figure 4.2.1-1 illustrates an overview of UE RRC state machine and state transitions in NR. A UE has only one RRC
state in NR at one time.",2.png
Figure 5.2.2.1-1: System information acquisition,"The UE applies the SI acquisition procedure to acquire the AS- and NAS information. The procedure applies to UEs in
RRC_IDLE, in RRC_INACTIVE and in RRC_CONNECTED.
The UE in RRC_IDLE and RRC_INACTIVE shall ensure having a valid version of (at least) the MIB, SIB1 through
SIB4 and SIB5 (if the UE supports E-UTRA).",3.png
"Figure 5.3.2.1-1: Paging
","Paging
General
UE
 Network
Paging
Figure 5.3.2.1-1: Paging
The purpose of this procedure is:
-
 to transmit paging information to a UE in RRC_IDLE or RRC_INACTIVE.
5.3.2.2
 Initiation
The network initiates the paging procedure by transmitting the Paging message at the UE's paging occasion as specified
in TS 38.304 [20]. The network may address multiple UEs within a Paging message by including one PagingRecord for
each UE.
5.3.2.3
 Reception of the Paging message by the UE
Upon receiving the Paging message, the UE shall:
1> if in RRC_IDLE, for each of the PagingRecord, if any, included in the Paging message:
2> if the ue-Identity included in the PagingRecord matches the UE identity allocated by upper layers:
3> forward the ue-Identity and accessType (if present) to the upper layers;
1> if in RRC_INACTIVE, for each of the PagingRecord, if any, included in the Paging message:
2> if the ue-Identity included in the PagingRecord matches the UE's stored fullI-RNTI:
3> if the UE is configured by upper layers with Access Identity 1:
4> initiate the RRC connection resumption procedure according to 5.3.13 with resumeCause set to mps-
PriorityAccess;
3> else if the UE is configured by upper layers with Access Identity 2:
ETSI
3GPP TS 38.331 version 15.7.0 Release 15
 40
 ETSI TS 138 331 V15.7.0 (2019-10)
4> initiate the RRC connection resumption procedure according to 5.3.13 with resumeCause set to mcs-
PriorityAccess;
3> else if the UE is configured by upper layers with one or more Access Identities equal to 11-15:
4> initiate the RRC connection resumption procedure according to 5.3.13 with resumeCause set to
highPriorityAccess;
3> else:
4> initiate the RRC connection resumption procedure according to 5.3.13 with resumeCause set to mt-
Access;
2> else if the ue-Identity included in the PagingRecord matches the UE identity allocated by upper layers:
3> forward the ue-Identity to upper layers and accessType (if present) to the upper layers;
3> perform the actions upon going to RRC_IDLE as specified in 5.3.11 with release cause 'other'.",4.png
"Figure 5.3.3.1-1: RRC connection establishment, successful
","The purpose of this procedure is to establish an RRC connection. RRC connection establishment involves SRB1
establishment. The procedure is also used to transfer the initial NAS dedicated information/ message from the UE to the
network.
The network applies the procedure e.g.as follows:
-
 When establishing an RRC connection;
-
 When UE is resuming or re-establishing an RRC connection, and the network is not able to retrieve or verify the
UE context. In this case, UE receives RRCSetup and responds with RRCSetupComplete.",5.png
"Figure 5.3.3.1-2: RRC connection establishment, network reject
","The purpose of this procedure is to establish an RRC connection. RRC connection establishment involves SRB1
establishment. The procedure is also used to transfer the initial NAS dedicated information/ message from the UE to the
network.
The network applies the procedure e.g.as follows:
-
 When establishing an RRC connection;
-
 When UE is resuming or re-establishing an RRC connection, and the network is not able to retrieve or verify the
UE context. In this case, UE receives RRCSetup and responds with RRCSetupComplete.",6.png
"Figure 5.3.4.1-1: Security mode command, successful
","UE
 Network
SecurityModeCommand
SecurityModeComplete The purpose of this procedure is to activate AS security upon RRC connection establishmen",7.png
"Figure 5.3.4.1-2: Security mode command, failure
","UE
 Network
SecurityModeCommand
SecurityModeFailure The purpose of this procedure is to activate AS security upon RRC connection establishmen",8.png
"Figure 5.3.5.1-1: RRC reconfiguration, successful
","UE
 Network
RRCReconfiguration
RRCReconfigurationComplete The purpose of this procedure is to modify an RRC connection, e.g. to establish/modify/release RBs, to perform
reconfiguration with sync, to setup/modify/release measurements, to add/modify/release SCells and cell groups. As part
of the procedure, NAS dedicated information may be transferred from the Network to the UE.",9.png
"Figure 5.3.5.1-2: RRC reconfiguration, failure","UE
 Network
RRCReconfiguration
RRC connection re-establishment",10.png
Figure 5.3.6.1-1: Counter check procedure,"UE
 Network
CounterCheck
CounterCheckResponse
Figure 5.3.6.1-1: Counter check procedure
The counter check procedure is used by the network to request the UE to verify the amount of data sent/ received on
each DRB. More specifically, the UE is requested to check if, for each DRB, the most significant bits of the COUNT
match with the values indicated by the network.
NOTE:
 The procedure enables the network to detect packet insertion by an intruder (a 'man in the middle').",11.png
"Figure 5.3.7.1-1: RRC connection re-establishment, successful","UE
 Network
RRCReestablishmentRequest
RRCReestablishment
RRCReestablishmentComplete The purpose of this procedure is to re-establish the RRC connection. A UE in RRC_CONNECTED, for which AS
security has been activated with SRB2 and at least one DRB setup, may initiate the procedure in order to continue the
RRC connection. The connection re-establishment succeeds if the network is able to find and verify a valid UE context
or, if the UE context cannot be retrieved, and the network responds with an RRCSetup according to clause 5.3.3.4.",12.png
"Figure 5.3.7.1-2: RRC re-establishment, fallback to RRC establishment, successful","UE
Network
RRCReestablishmentRequest
RRCSetup
RRCSetupComplete The purpose of this procedure is to re-establish the RRC connection. A UE in RRC_CONNECTED, for which AS
security has been activated with SRB2 and at least one DRB setup, may initiate the procedure in order to continue the
RRC connection. The connection re-establishment succeeds if the network is able to find and verify a valid UE context
or, if the UE context cannot be retrieved, and the network responds with an RRCSetup according to clause 5.3.3.4.",13.png
"Figure 5.3.8.1-1: RRC connection release, successful","UE
 Network
RRCRelease The purpose of this procedure is:
-
 to release the RRC connection, which includes the release of the established radio bearers as well as all radio
resources; or
-
 to suspend the RRC connection only if SRB2 and at least one DRB are setup, which includes the suspension of
the established radio bearers.",14.png
"Figure 5.3.13.1-1: RRC connection resume, successful
","UE
 Network
RRCResumeRequest/RRCResumeRequest1
RRCResume
RRCResumeComplete The purpose of this procedure is to resume a suspended RRC connection, including resuming SRB(s) and DRB(s) or
perform an RNA update.",15.png
"Figure 5.3.13.1-2: RRC connection resume fallback to RRC connection establishment, successful
","UE
 Network
RRCResumeRequest/RRCResumeRequest1
RRCSetup
RRCSetupComplete The purpose of this procedure is to resume a suspended RRC connection, including resuming SRB(s) and DRB(s) or
perform an RNA update.",16.png
"Figure 5.3.13.1-3: RRC connection resume followed by network release, successful
","UE
 Network
RRCResumeRequest/RRCResumeRequest1
RRCRelease The purpose of this procedure is to resume a suspended RRC connection, including resuming SRB(s) and DRB(s) or
perform an RNA update.",17.png
"Figure 5.3.13.1-4: RRC connection resume followed by network suspend, successful","UE
 Network
RRCResumeRequest/RRCResumeRequest1
RRCRelease with suspend configuration The purpose of this procedure is to resume a suspended RRC connection, including resuming SRB(s) and DRB(s) or
perform an RNA update.",18.png
"Figure 5.3.13.1-5: RRC connection resume, network reject","UE
 Network
RRCResumeRequest/RRCResumeRequest1
RRCReject The purpose of this procedure is to resume a suspended RRC connection, including resuming SRB(s) and DRB(s) or
perform an RNA update.",19.png
"Figure 5.4.2.1-1: Handover to NR, successful
","UE
 Network
RRCReconfiguration (sent via other RAT)
RRCReconfigurationComplete
Figure 5.4.2.1-1: Handover to NR, successful
The purpose of this procedure is to, under the control of the network, transfer a connection between the UE and another
Radio Access Network (e.g. E-UTRAN) to NR.
The handover to NR procedure applies when SRBs, possibly in combination with DRBs, are established in another
RAT. Handover from E-UTRA to NR applies only after integrity has been activated in E-UTRA.",20.png
"Figure 5.4.3.1-1: Mobility from NR, successful
","UE
 Network
MobilityFromNRCommand The purpose of this procedure is to move a UE in RRC_CONNECTED to a cell using other RAT, e.g. E-UTRA. The
mobility from NR procedure covers the following type of mobility:
-
 handover, i.e. the MobilityFromNRCommand message includes radio resources that have been allocated for the
UE in the target cell;",21.png
"Figure 5.4.3.1-2: Mobility from NR, failure","UE
 Network
MobilityFromNRCommand
RRC connection re-establishment The purpose of this procedure is to move a UE in RRC_CONNECTED to a cell using other RAT, e.g. E-UTRA. The
mobility from NR procedure covers the following type of mobility:
-
 handover, i.e. the MobilityFromNRCommand message includes radio resources that have been allocated for the
UE in the target cell;",22.png
"Figure 5.5.5.1-1: Measurement reporting
","The purpose of this procedure is to transfer measurement results from the UE to the network. The UE shall initiate this
procedure only after successful AS security activation.
For the measId for which the measurement reporting procedure was triggered, the UE shall set the measResults within
the MeasurementReport message as follows:
1> set the measId to the measurement identity that triggered the measurement reporting;
1> for each serving cell configured with servingCellMO:
2> if the reportConfig associated with the measId that triggered the measurement reporting includes rsType:
3> if the serving cell measurements based on the rsType included in the reportConfig that triggered the
measurement report are available:
4> set the measResultServingCell within measResultServingMOList to include RSRP, RSRQ and the
available SINR of the serving cell, derived based on the rsType included in the reportConfig that
triggered the measurement report;
2> else:
3> if SSB based serving cell measurements are available:
4> set the measResultServingCell within measResultServingMOList to include RSRP, RSRQ and the
available SINR of the serving cell, derived based on SSB;
3> else if CSI-RS based serving cell measurements are available:
4> set the measResultServingCell within measResultServingMOList to include RSRP, RSRQ and the
available SINR of the serving cell, derived based on CSI-RS;",23.png
"Figure 5.5.5.1-1: Location measurement indication
","UE
 Network
LocationMeasurementIndication
Figure 5.5.5.1-1: Location measurement indication
The purpose of this procedure is to indicate to the network that the UE is going to start/stop location related
measurements (eutra-RSTD) which require measurement gaps or start/stop subframe and slot timing detection towards",24.png
"Figure 5.6.1.1-1: UE capability transfer
","This clause describes how the UE compiles and transfers its UE capability information upon receiving a
UECapabilityEnquiry from the network. UE
 Network
UECapabilityEnqiry
UECapabilityInformation",25.png
"Figure 5.7.1.1-1: DL information transfer
","UE
 Network
DLInformationTransfer The purpose of this procedure is to transfer NAS dedicated information from NG-RAN to a UE in
RRC_CONNECTED.",26.png
"Figure 5.7.2.1-1: UL information transfer
","UE
 Network
ULInformationTransfer The purpose of this procedure is to transfer NAS dedicated information from the UE to the network.",27.png
Figure 5.7.2a.1-1: UL information transfer MR-DC,"UE
 Network
ULInformationTransferMRDC
Figure 5.7.2a.1-1: UL information transfer MR-DC
The purpose of this procedure is to transfer MR-DC dedicated information from the UE to the network e.g. the NR or E-
UTRA RRC MeasurementReport and FailureInformation message.",28.png
Figure 5.7.3.1-1: SCG failure information,"UE
 Network
RRC reconfiguration
SCGFailureInformation
Figure 5.7.3.1-1: SCG failure information
The purpose of this procedure is to inform E-UTRAN or NR MN about an SCG failure the UE has experienced i.e.
SCG radio link failure, failure of SCG reconfiguration with sync, SCG configuration failure for RRC message on SRB3
and SCG integrity check failure.",29.png
Figure 5.7.3a.1-1: EUTRA SCG failure information,"UE
 Network
RRC reconfiguration
SCGFailureInformationEUTRA
Figure 5.7.3a.1-1: EUTRA SCG failure information The purpose of this procedure is to inform NR MN about an SCG failure on E-UTRA SN the UE has experienced (e.g.
SCG radio link failure, SCG change failure), as specified in TS 36.331 [10] clause 5.6.13.2.",30.png
"Figure 5.7.4.1-1: UE Assistance Information
","UE
Network
RRC reconfiguration
UEAssistanceInformation
Figure 5.7.4.1-1: UE Assistance Information
The purpose of this procedure is to inform the network of the UE's delay budget report carrying desired
increment/decrement in the connected mode DRX cycle length, or overheating assistance information",31.png
Figure 5.7.5.1-1: Failure information,"UE
 Network
FailureIndication
Figure 5.7.5.1-1: Failure information
The purpose of this procedure is to inform the network about a failure detected by the UE.",32.png
Figure 8.5-1: RRC level padding,"Padding
If the encoded RRC message does not fill a transport block, the RRC layer shall add padding bits. This applies to PCCH
and BCCH.
Padding bits shall be set to 0 and the number of padding bits is a multiple of 8.
RRC- ASN.1
RRC message
 Extension
ASN.1 encoder
Basic production (always a multiple of 8 bits)
RRC- PDU
RRC padding
Basic production
Figure 8.5-1: RRC level padding
RRC level
padding",33.png
"Figure 12.1-1: Illustration of RRC procedure delay
","The UE performance requirements for RRC procedures are specified in the following tables. The performance requirement is expressed as the time in [ms] from the end of
reception of the network -> UE message on the UE physical layer up to when the UE shall be ready for the reception of uplink grant for the UE -> network response message
with no access delay other than the TTI-alignment (e.g. excluding delays caused by scheduling, the random access procedure or physical layer synchronisation). In case the
RRC procedure triggers BWP switching, the RRC procedure delay is the value defined in the following table plus the BWP switching delay defined in TS 38.133 [14], clause
8.6.3.",34.png
"Figure 5.2-1: NG and Uu user plane
"," User plane
The PDU Session Resource service is offered from SAP to SAP by the Access Stratum. Figure 5.2-1 shows the
protocols on the Uu and the NG interfaces that linked together provide this PDU Session Resource service.
Non-Access Stratum
Radio
 Radio
 NG
 NG
proto-
 proto-
 proto
 proto
cols
 cols
 cols
 cols
(1)
 (1)
 (2)
 (2)
UE
Radio
(Uu)
Access Stratum
NG-RAN
NG
5GC
NOTE 1: The radio interface protocols are defined in TS 38.2xx and TS 38.3xx.
NOTE 2: The NG interface protocols are defined in TS 38.41x.
Figure 5.2-1: NG and Uu user plane",35.png
"Figure 5.3-1: NG and Uu control plane
"," Control plane
Figure 5.3-1 shows the control plane (signalling) protocol stacks on NG and Uu interfaces.
CM,SM
 (3)
 Non-Access Stratum
 CM,SM
 (3)
Radio
 Radio
 NG
 NG
proto-
 proto-
 proto
 proto
cols
 cols
 cols
 cols
(1)
 (1)
 (2)
 (2)
UE
Radio
(Uu)
Access Stratum
NG-RAN
NG
5GC
NOTENOTENOTE1:2:3:The radio interface protocols are defined in TS 38.2xx and TS 38.3xx.
The protocol is defined in TS 38.41x. (Description of NG interface).
CM, SM: This exemplifies a set of NAS control protocols between UE and 5GC. The evolution of the
protocol architecture for these protocols is outside the scope of the present document.
Figure 5.3-1: NG and Uu control plane",36.png
Figure 6.1-1: Overall architecture,"Overall Architecture of NG-RAN The NG-RAN consists of a set of gNBs connected to the 5GC through the NG interface.
NOTE:
 As specified in TS 38.300 [2], NG-RAN could also consists of a set of ng-eNBs, an ng-eNB may consist
of an ng-eNB-CU and one or more ng-eNB-DU(s). An ng-eNB-CU and an ng-eNB-DU is connected via
W1 interface. The general principle described in this clause also applies to ng-eNB and W1 interface, if
not explicitly specified otherwise.
An gNB can support FDD mode, TDD mode or dual mode operation.
gNBs can be interconnected through the Xn interface.
A gNB may consist of a gNB-CU and one or more gNB-DU(s). A gNB-CU and a gNB-DU is connected via F1
interface.
One gNB-DU is connected to only one gNB-CU.
NOTE:
 In case of network sharing with multiple cell ID broadcast, each Cell Identity associated with a subset of
PLMNs corresponds to a gNB-DU and the gNB-CU it is connected to, i.e. the corresponding gNB-DUs
share the same physical layer cell resources.
NOTE:
 For resiliency, a gNB-DU may be connected to multiple gNB-CUs by appropriate implementation.
NG, Xn and F1 are logical interfaces.
For NG-RAN, the NG and Xn-C interfaces for a gNB consisting of a gNB-CU and gNB-DUs, terminate in the gNB-
CU. For EN-DC, the S1-U and X2-C interfaces for a gNB consisting of a gNB-CU and gNB-DUs, terminate in the
gNB-CU. The gNB-CU and connected gNB-DUs are only visible to other gNBs and the 5GC as a gNB. A possible
deployment scenario is described in Annex A.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 15
 ETSI TS 138 401 V17.6.0 (2023-10)
The node hosting user plane part of NR PDCP (e.g. gNB-CU, gNB-CU-UP, and for EN-DC, MeNB or SgNB
depending on the bearer split) shall perform user inactivity monitoring and further informs its inactivity or (re)activation
to the node having C-plane connection towards the core network (e.g. over E1, X2). The node hosting NR RLC (e.g.
gNB-DU) may perform user inactivity monitoring and further inform its inactivity or (re)activation to the node hosting
control plane, e.g. gNB-CU or gNB-CU-CP.
UL PDCP configuration (i.e. how the UE uses the UL at the assisting node) is indicated via X2-C (for EN-DC), Xn-C
(for NG-RAN) and F1-C. Radio Link Outage/Resume for DL and/or UL is indicated via X2-U (for EN-DC), Xn-U (for
NG-RAN) and F1-U.
The NG-RAN is layered into a Radio Network Layer (RNL) and a Transport Network Layer (TNL).
The NG-RAN architecture, i.e. the NG-RAN logical nodes and interfaces between them, is defined as part of the RNL.
For each NG-RAN interface (NG, Xn, F1) the related TNL protocol and the functionality are specified. The TNL
provides services for user plane transport, signalling transport.
In NG-Flex configuration, each NG-RAN node is connected to all AMFs of AMF Sets within an AMF Region
supporting at least one slice also supported by the NG-RAN node. The AMF Set and the AMF Region are defined in
TS 23.501 [3].
If security protection for control plane and user plane data on TNL of NG-RAN interfaces has to be supported, NDS/IP
TS 33.501 [13] shall be applied.",37.png
Figure 6.1.2-1. Overall architecture for separation of gNB-CU-CP and gNB-CU-UP," Overall architecture for separation of gNB-CU-CP and gNB-CU-UP
The overall architecture for separation of gNB-CU-CP and gNB-CU-UP is depicted in Figure 6.1.2-1.
NOTE:
NG-RAN could also consist of a set of ng-eNBs, an ng-eNB may consist of an ng-eNB-CU-CP, one or
more ng-eNB-CU-UP(s), and one or more ng-eNB-DU(s). An ng-eNB-CU-CP and an ng-eNB-CU-UP is
connected via the E1 interface. An ng-eNB-DU is connected to an ng-eNB-CU-CP via the W1-C
interface, and to an ng-eNB-CU-UP via the W1-U interface. The general principle described in this clause
also applies to ng-eNB and its corresponding E1 and W1 interfaces, if not explicitly specified otherwise.
-
-
-
-
-
-
gNB-CU-CP
 gNB-CU-UP
E1
F1-C
 F1-U
gNB-DU
 gNB-DU
gNB
Figure 6.1.2-1. Overall architecture for separation of gNB-CU-CP and gNB-CU-UP
A gNB may consist of a gNB-CU-CP, multiple gNB-CU-UPs and multiple gNB-DUs;
The gNB-CU-CP is connected to the gNB-DU through the F1-C interface;
The gNB-CU-UP is connected to the gNB-DU through the F1-U interface;
The gNB-CU-UP is connected to the gNB-CU-CP through the E1 interface;
One gNB-DU is connected to only one gNB-CU-CP;
One gNB-CU-UP is connected to only one gNB-CU-CP;
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 16
 ETSI TS 138 401 V17.6.0 (2023-10)
NOTE 1: For resiliency, a gNB-DU and/or a gNB-CU-UP may be connected to multiple gNB-CU-CPs by
appropriate implementation.
-
 One gNB-DU can be connected to multiple gNB-CU-UPs under the control of the same gNB-CU-CP;
-
 One gNB-CU-UP can be connected to multiple DUs under the control of the same gNB-CU-CP;
NOTE 2: The connectivity between a gNB-CU-UP and a gNB-DU is established by the gNB-CU-CP using
Bearer Context Management functions.
NOTE 3: The gNB-CU-CP selects the appropriate gNB-CU-UP(s) for the requested services for the UE. In case
of multiple CU-UPs they belong to same security domain as defined in TS 33.210 [18].
NOTE 4: Data forwarding between gNB-CU-UPs during intra-gNB-CU-CP handover within a gNB may be
supported by Xn-U.",38.png
Figure 6.1.3-1: Overall architecture of IAB,"The NG-RAN supports IAB by the IAB-node wirelessly connecting to the gNB capable of serving the IAB-nodes,
named IAB-donor.
The IAB-donor consists of an IAB-donor-CU and one or more IAB-donor-DU(s). In case of separation of gNB-CU-CP
and gNB-CU-UP, the IAB-donor may consist of an IAB-donor-CU-CP, multiple IAB-donor-CU-UPs and multiple
IAB-donor-DUs.
The IAB-node connects to an upstream IAB-node or an IAB-donor-DU via a subset of the UE functionalities of the NR
Uu interface (named IAB-MT function of IAB-node). The IAB-node provides wireless backhaul to the downstream
IAB-nodes and UEs via the network functionalities of the NR Uu interface (named IAB-DU function of IAB-node).
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 17
 ETSI TS 138 401 V17.6.0 (2023-10)
The F1-C traffic between an IAB-node and IAB-donor-CU is backhauled via the IAB-donor-DU and the optional
intermediate hop IAB-node(s).
The F1-U traffic between an IAB-node and IAB-donor-CU is backhauled via the IAB-donor-DU and the optional
intermediate hop IAB-node(s).
All functions specified for a gNB-DU are equally applicable for an IAB-DU and IAB-donor-DU, unless otherwise
stated, and all functions specified for a gNB-CU are equally applicable for an IAB-donor-CU, unless otherwise stated.
All functions specified for the UE context are equally applicable for managing the context of IAB-MT, unless otherwise
stated.",39.png
"Figure 6.1.4-1: Protocol stack for F1-U of IAB
","Figure 6.1.4-1 shows the protocol stack for F1-U between IAB-DU and the IAB-donor-CU-UP, and Figure 6.1.4-2
shows the protocol stack for F1-C between IAB-DU and the IAB-donor-CU-CP. In these example figures, F1-U and
F1-C traffic are carried over two backhaul hops.",40.png
Figure. 6.1.4-2: Protocol stack for F1-C of IAB,"Figure 6.1.4-1 shows the protocol stack for F1-U between IAB-DU and the IAB-donor-CU-UP, and Figure 6.1.4-2
shows the protocol stack for F1-C between IAB-DU and the IAB-donor-CU-CP. In these example figures, F1-U and
F1-C traffic are carried over two backhaul hops.",41.png
Fig. 6.1.4-3: Protocol stack for IAB F1-C traffic exchanged via the MeNB,"Figure 6.1.4-3 shows the protocol stack for F1-C between IAB-DU and the IAB-donor-CU-CP, when the F1-C
traffic is exchanged via the MeNB.",42.png
Fig. 6.1.4-4: Protocol stack for IAB F1-C traffic exchanged via the MgNB,"Figure 6.1.4-4 shows the protocol stack for F1-C between IAB-DU and the IAB-donor-CU-CP, when the F1-C
traffic is exchanged via the MgNB",43.png
Fig. 6.1.4-5: Protocol stack for IAB F1-C traffic exchanged via the SgNB,"Figure 6.1.4-5 shows the protocol stack for F1-C between IAB-DU and the IAB-donor-CU-CP, when the F1-C
traffic is exchanged via the SgNB",44.png
"Figure 6.1.6-1: User plane protocol stack for L2 UE-to-Network Relay
","The protocol stacks for the user plane and control plane of L2 U2N Relay architecture are described in Figure 6.1.6-1
and Figure 6.1.6-2, respectively. The Uu SRAP is terminated between U2N relay UE and gNB-DU.",45.png
"Figure 6.1.6-2: Control plane protocol stack for L2 UE-to-Network Relay
","The protocol stacks for the user plane and control plane of L2 U2N Relay architecture are described in Figure 6.1.6-1
and Figure 6.1.6-2, respectively. The Uu SRAP is terminated between U2N relay UE and gNB-DU.",46.png
Figure 8.1-1: UE Initial Access procedure," The UE sends an RRCSetupRequest message to the gNB-DU.
2. The gNB-DU includes the RRC message and, if the UE is admitted, the corresponding low layer configuration
for the UE in the INITIAL UL RRC MESSAGE TRANSFER message and transfers to the gNB-CU. The
INITIAL UL RRC MESSAGE TRANSFER message includes the C-RNTI allocated by the gNB-DU. If the
gNB-DU identifies the UE as a Reduced Capability UE during the random access procedure, a NR RedCap UE
Indication is provided in the INITIAL UL RRC MESSAGE TRANSFER message.
3. The gNB-CU allocates a gNB-CU UE F1AP ID for the UE and generates a RRCSetup message towards UE.
The RRC message is encapsulated in -the DL RRC MESSAGE TRANSFER message.
4. The gNB-DU sends the RRCSetup message to the UE.
5. The UE sends the RRC CONNECTION SETUP COMPLETE message to the gNB-DU.
6. The gNB-DU encapsulates the RRC message in the UL RRC MESSAGE TRANSFER message and sends it to
the gNB-CU.
7. The gNB-CU sends the INITIAL UE MESSAGE message to the AMF.
8. The AMF sends the INITIAL CONTEXT SETUP REQUEST message to the gNB-CU.
9. The gNB-CU sends the UE CONTEXT SETUP REQUEST message to establish the UE context in the gNB-DU.
In this message, it may also encapsulate the SecurityModeCommand message. In case of NG-RAN sharing, the
gNB-CU includes the serving PLMN ID (for SNPNs the serving SNPN ID).
10. The gNB-DU sends the SecurityModeCommand message to the UE.
11. The gNB-DU sends the UE CONTEXT SETUP RESPONSE message to the gNB-CU.
12. The UE responds with the SecurityModeComplete message.The gNB-DU encapsulates the RRC message in the UL RRC MESSAGE TRANSFER message and sends it to
the gNB-CU.
14. The gNB-CU generates the RRCReconfiguration message and encapsulates it in the DL RRC MESSAGE
TRANSFER message.
15. The gNB-DU sends RRCReconfiguration message to the UE.
16. The UE sends RRCReconfigurationComplete message to the gNB-DU.
17. The gNB-DU encapsulates the RRC message in the UL RRC MESSAGE TRANSFER message and send it to
the gNB-CU.
18. The gNB-CU sends the INITIAL CONTEXT SETUP RESPONSE message to the AMF.",47.png
"Figure 8.2.1.1-1: Inter-gNB-DU Mobility for intra-NR
","Inter-gNB-DU Mobility
This procedure is used for the case when the UE moves from one gNB-DU to another gNB-DU within the same gNB-
CU during NR operation. Figure 8.2.1.1-1 shows the inter-gNB-DU mobility procedure for intra-NR. . The UE sends a MeasurementReport message to the source gNB-DU.2. The source gNB-DU sends an UL RRC MESSAGE TRANSFER message to the gNB-CU to convey the
received MeasurementReport message.
2a. The gNB-CU may send an UE CONTEXT MODIFICATION REQUEST message to the source gNB-DU to
query the latest configuration.
2b. The source gNB-DU responds with an UE CONTEXT MODIFICATION RESPONSE message that includes full
configuration information.
3. The gNB-CU sends an UE CONTEXT SETUP REQUEST message to the target gNB-DU to create an UE
context and setup one or more data bearers. The UE CONTEXT SETUP REQUEST message includes a
HandoverPreparationInformation. In case of NG-RAN sharing, the gNB-CU includes the serving PLMN ID (for
SNPNs the serving SNPN ID).
4. The target gNB-DU responds to the gNB-CU with an UE CONTEXT SETUP RESPONSE message.
5. The gNB-CU sends a UE CONTEXT MODIFICATION REQUEST message to the source gNB-DU, which
includes a generated RRCReconfiguration message and indicates to stop the data transmission for the UE. The
source gNB-DU also sends a Downlink Data Delivery Status frame to inform the gNB-CU about the
unsuccessfully transmitted downlink data to the UE.
NOTE:
 In case of DAPS Handover, the UE CONTEXT MODIFICATION REQUEST message in step 5 may
indicate to stop the data transmission only for the DRB(s) not subject to DAPS Handover or may not
indicate to stop the data transmission at all. Instead, the DL RRC Message Transfer procedure can be used
to carry the handover command to the UE. The UE CONTEXT MODIFICATION REQUEST message
that indicates to stop the data transmission for the UE is sent to the source gNB-DU once the gNB-CU
knows that the UE has successfully accessed the target gNB-DU, for which the source gNB-DU sends a
DDDS frame about the unsuccessfully transmitted downlink data to the gNB-CU.
6. The source gNB-DU forwards the received RRCReconfiguration message to the UE.
7. The source gNB-DU responds to the gNB-CU with the UE CONTEXT MODIFICATION RESPONSE message.
8. A Random Access procedure is performed at the target gNB-DU. The target gNB-DU sends a Downlink Data
Delivery Status frame to inform the gNB-CU. Downlink packets, which may include PDCP PDUs not
successfully transmitted in the source gNB-DU, are sent from the gNB-CU to the target gNB-DU.
NOTE:
 It is up to gNB-CU implementation whether to start sending DL User Data to gNB-DU before or after
reception of the Downlink Data Delivery Status.
9. The UE responds to the target gNB-DU with an RRCReconfigurationComplete message.
10. The target gNB-DU sends an UL RRC MESSAGE TRANSFER message to the gNB-CU to convey the received
RRCReconfigurationComplete message. Downlink packets are sent to the UE. Also, uplink packets are sent from
the UE, which are forwarded to the gNB-CU through the target gNB-DU.
11. The gNB-CU sends an UE CONTEXT RELEASE COMMAND message to the source gNB-DU.
12. The source gNB-DU releases the UE context and responds the gNB-CU with an UE CONTEXT RELEASE
COMPLETE message.",48.png
"Figure 8.2.1.3-1: Inter-gNB-DU Conditional Handover or Conditional PSCell Change for intra-NR
","Inter-gNB-DU Conditional Handover or Conditional PSCell Change
This procedure is used for the case when the UE moves from one gNB-DU to another gNB-DU within the same gNB-
CU during NR operation for conditional handover or conditional PSCell change. Figure 8.2.1.3-1 shows the inter-gNB-
DU conditional mobility procedure for intra-NR.3. The gNB-CU sends an UE CONTEXT SETUP REQUEST message to the candidate gNB-DU to create an UE
context and setup one or more data bearers. The UE CONTEXT SETUP REQUEST message is sent for each
candidate cell and includes a HandoverPreparationInformation (conditional handover) or a CG-ConfigInfo
(conditional PSCell change).
4. The candidate gNB-DU responds to the gNB-CU with an UE CONTEXT SETUP RESPONSE message
including the target cell ID that was requested from the gNB-CU. The response message is sent for each
requested candidate cell.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 32
 ETSI TS 138 401 V17.6.0 (2023-10)
5. The gNB-CU sends a DL RRC MESSAGE TRANSFER message to the source gNB-DU, which includes a
generated RRCReconfiguration message.
6. The step 6 is as defined in clause 8.2.1.1.
7-8. The UE responds to the source gNB-DU with an RRCReconfigurationComplete message, for which the
source gNB-DU forwards to the gNB-CU via an UL RRC MESSAGE TRANSFER message.
9. An execution condition to trigger initiation of conditional handover or conditional PSCell change is fulfilled.
10. A Random Access procedure is performed at the candidate gNB-DU, which becomes the target gNB-DU if
successful. The target gNB-DU sends a Downlink Data Delivery Status frame to inform the gNB-CU. The target
gNB-DU also sends an ACCESS SUCCESS message to inform the gNB-CU of which cell the UE has
successfully accessed.
11-12. The steps 11-12 are as defined in steps 9-10 in clause 8.2.1.1.
13. The gNB-CU sends a UE CONTEXT MODIFICATION REQUEST message to the source gNB-DU and
indicates to stop the data transmission for the UE. The source gNB-DU also sends a Downlink Data Delivery
Status frame to inform the gNB-CU about the unsuccessfully transmitted downlink data to the UE. Downlink
packets, which may include PDCP PDUs not successfully transmitted in the source gNB-DU, are sent from the
gNB-CU to the target gNB-DU.
NOTE:
 The step 13 may happen before step 12, as soon as the gNB-CU knows which cell the UE has
successfully accessed.
NOTE:
 The gNB-CU may initiate UE Context Release procedure toward the other signalling connections or other
candidate target gNB-DUs, if any, to cancel conditional handover or conditional PSCell change for the
UE.
14. The source gNB-DU responds to the gNB-CU with the UE CONTEXT MODIFICATION RESPONSE message.
15 -16.
 The steps 15-16 are as defined in steps 11-12 in clause 8.2.1.1.",49.png
Figure 8.2.2.1-1: Inter-gNB-DU Mobility using MCG SRB in EN-DC,"This procedure is used for the case the UE moves from one gNB-DU to another gNB-DU within the same gNB-CU
when only MCG SRB is available during EN-DC operation. Figure 8.2.2.1-1 shows the inter-gNB-DU mobility
procedure using MCG SRB in EN-DC.1. The UE sends an ULInformationTransferMRDC message to the MeNB.
2. The MeNB sends RRC TRANSFER message to the gNB-CU.
3. The gNB-CU may send UE CONTEXT MODIFICATION REQUEST message to the source gNB-DU to query
the latest SCG configuration.
4. The source gNB-DU responds with an UE CONTEXT MODIFICATION RESPONSE message that includes
full configuration information.
5. The gNB-CU sends an UE CONTEXT SETUP REQUEST message to the target gNB-DU to create an UE
context and setup one or more data bearers. The UE CONTEXT SETUP REQUEST message includes a CG
ConfigInfo.
6. The target gNB-DU responds the gNB-CU with an UE CONTEXT SETUP RESPONSE message.
7. The gNB-CU sends a UE CONTEXT MODIFICATION REQUEST message to the source gNB-DU indicating
to stop the data transmission to the UE. The source gNB-DU also sends a Downlink Data Delivery Status frame
to inform the gNB-CU about the unsuccessfully transmitted downlink data to the UE.
8. The source gNB-DU responds the gNB-CU with an UE CONTEXT MODIFICATION RESPONSE message.
9. The gNB-CU sends an SGNB MODIFICATION REQUIRED message to the MeNB.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 34
 ETSI TS 138 401 V17.6.0 (2023-10)
10/11. The MeNB Initiated SgNB Modification procedure may be triggered by the SgNB Initiated SgNB
Modification procedure (e.g. to provide information such as data forwarding addresses, new SN security key,
measurement gap, etc...).
12. The MeNB and the UE perform RRC Connection Reconfiguration procedure.
13. The MeNB sends an SGNB MODIFICATION CONFIRM message to the gNB-CU.
14. Random Access procedure is performed at the target gNB-DU. The target gNB-DU sends a Downlink Data
Delivery Status frame to inform the gNB-CU. Downlink packets, which may include PDCP PDUs not
successfully transmitted in the source gNB-DU, are sent from the gNB-CU to the target gNB-DU. Downlink
packets are sent to the UE. Also, uplink packets are sent from the UE, which are forwarded to the gNB-CU
through the target gNB-DU.
NOTE:
 It is up to gNB-CU implementation whether to start sending DL User Data to gNB-DU before or after
reception of the Downlink Data Delivery Status.
15. The gNB-CU sends an UE CONTEXT RELEASE COMMAND message to the source gNB-DU.
16. The source gNB-DU releases the UE context and responds the gNB-CU with an UE CONTEXT RELEASE
COMPLETE message.",50.png
Figure 8.2.2.3-1: Inter-gNB-DU Conditional PSCell Change using MCG SRB without MN negotiation in EN-DC,"This procedure is used for the case where the UE moves from one gNB-DU to another gNB-DU within the same gNB-
CU when only MCG SRB is available and the MN’s configuration is not changed during EN-DC operation for
conditional PSCell change. Figure 8.2.2.3-1 shows the inter-gNB-DU conditional PSCell change procedure using MCG
SRB in EN-DC.1-4.
 The steps 1-4 are as defined in clause 8.2.2.1.
5. The gNB-CU sends an UE CONTEXT SETUP REQUEST message to the candidate gNB-DU to create an UE
context and setup one or more data bearers. The UE CONTEXT SETUP REQUEST message is sent for each
candidate cell and includes a CG-ConfigInfo.
6. The candidate gNB-DU responds the gNB-CU with an UE CONTEXT SETUP RESPONSE message including
the target cell ID that was requested from the gNB-CU. The response message is sent for each requested
candidate cell.
7. The gNB-CU sends an SGNB MODIFICATION REQUIRED message to the MeNB, which includes a
generated RRCReconfiguration message.
8. The MeNB and the UE perform RRC Connection Reconfiguration/Complete procedure.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 36
 ETSI TS 138 401 V17.6.0 (2023-10)
9. The MeNB sends an SGNB MODIFICATION CONFIRM message to the gNB-CU, to convey the received
RRCReconfigurationComplete message at step 8.
10. An execution condition to trigger initiation of conditional PSCell change is fulfilled.
11. Random Access procedure is performed at the candidate gNB-DU, which becomes the target gNB-DU if
successful. The target gNB-DU sends a Downlink Data Delivery Status frame to inform the gNB-CU. The target
gNB-DU also sends an ACCESS SUCCESS message to inform the gNB-CU of which cell the UE has
successfully accessed.
12-13. The UE responds with an RRCReconfigurationComplete message (embedded in an
ULInformationTransferMRDC message), which the MeNB forwards to the gNB-CU via an RRC TRANSFER
message.
14. The gNB-CU sends a UE CONTEXT MODIFICATION REQUEST message to the source gNB-DU and
indicates to stop the data transmission for the UE. The source gNB-DU sends a Downlink Data Delivery Status
frame to inform the gNB-CU about the unsuccessfully transmitted downlink data to the UE. Downlink packets,
which may include PDCP PDUs not successfully transmitted in the source gNB-DU, are sent from the gNB-CU
to the target gNB-DU. Downlink packets are sent to the UE. Also, uplink packets are sent from the UE, which
are forwarded to the gNB-CU through the target gNB-DU.
NOTE:
 The step 14 may happen before step 13, as soon as the gNB-CU knows which cell the UE has
successfully accessed.
NOTE:
 The gNB-CU may initiate UE Context Release procedure toward the other signalling connections or other
candidate target gNB-DUs, if any, to cancel conditional PSCell change for the UE.
15. The source gNB-DU responds to the gNB-CU with the UE CONTEXT MODIFICATION RESPONSE message.
16-17. The steps 16-17 are as defined in steps 11-12 in clause 8.2.1.1.",51.png
Figure 8.2.3.1-1: IAB intra-CU topology adaptation procedure," The migrating IAB-MT sends a MeasurementReport message to the source parent node IAB-DU. This report is
based on a Measurement Configuration the migrating IAB-MT received from the IAB-donor-CU before.
2.The source parent node IAB-DU sends an UL RRC MESSAGE TRANSFER message to the IAB-donor-CU to
convey the received MeasurementReport.
3.The IAB-donor-CU sends a UE CONTEXT SETUP REQUEST message to the target parent node IAB-DU to
create the UE context for the migrating IAB-MT and set up one or more bearers. These bearers can be used by
the migrating IAB-MT for its own signalling, and, optionally, data traffic.
4. The target parent node IAB-DU responds to the IAB-donor-CU with a UE CONTEXT SETUP RESPONSE
message.
5. The IAB-donor-CU sends a UE CONTEXT MODIFICATION REQUEST message to the source parent node
IAB-DU, which includes a generated RRCReconfiguration message. The RRCReconfiguration message includes
a default BH RLC channel and a default BAP Routing ID configuration for UL F1-C/non-F1 traffic mapping on
the target path. It may include additional BH RLC channels. This step may also include allocation of TNL
address(es) that is (are) routable via the target IAB-donor-DU. The new TNL address(es) may be included in the
RRCReconfiguration message as a replacement for the TNL address(es) that is (are) routable via the source IAB-
donor-DU. In case IPsec tunnel mode is used to protect the F1 and non-F1 traffic, the allocated TNL address is
outer IP address. The TNL address replacement is not necessary if the source and target paths use the same IAB-
donor-DU. The Transmission Action Indicator in the UE CONTEXT MODIFICATION REQUEST message
indicates to stop the data transmission to the migrating IAB-node.
6. The source parent node IAB-DU forwards the received RRCReconfiguration message to the migrating IAB-MT.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 38
 ETSI TS 138 401 V17.6.0 (2023-10)
7.The source parent node IAB-DU responds to the IAB-donor-CU with the UE CONTEXT MODIFICATION
RESPONSE message.
8. A Random Access procedure is performed at the target parent node IAB-DU.
9. The migrating IAB-MT responds to the target parent node IAB-DU with an RRCReconfigurationComplete
message.
10. The target parent node IAB-DU sends an UL RRC MESSAGE TRANSFER message to the IAB-donor-CU to
convey the received RRCReconfigurationComplete message. Also, uplink packets can be sent from the migrating
IAB-MT, which are forwarded to the IAB-donor-CU through the target parent node IAB-DU. These UL packets
belong to the IAB-MT’s own signalling and, optionally, data traffic.
11. The IAB-donor-CU configures BH RLC channels and BAP-sublayer routing entries on the target path between
the target parent IAB-node and target IAB-donor-DU as well as DL mappings on the target IAB-donor-DU for
the migrating IAB-node’s target path. These configurations may be performed at an earlier stage, e.g.
immediately after step 3, or before step 3. The IAB-donor-CU may establish additional BH RLC channels to the
migrating IAB-MT via RRC message.
12. The F1-C connections are switched to use the migrating IAB-node’s new TNL address(es), IAB-donor-CU
updates the UL BH information associated to each GTP-tunnel to migrating IAB-node. This step may also
update UL FTEID and DL FTEID associated to each GTP-tunnel. All F1-U tunnels are switched to use the
migrating IAB-node’s new TNL address(es). This step may use non-UE associated signaling in E1 and/or F1
interface to provide updated UP configuration for F1-U tunnels of multiple connected UEs or child IAB-MTs.
The IAB-donor-CU may also update the UL BH information associated with non-UP traffic. Implementation
must ensure the avoidance of potential race conditions, i.e. no conflicting configurations are concurrently
performed using UE-associated and non-UE-associated procedures.
In case IPsec tunnel mode is used for TNL protection, the IAB-node may use MOBIKE (IETF RFC 4555 [29])
to migrate the IPsec tunnel to the new IP outer addresses. After the completion of the MOBIKE procedure, the
IAB-DU initiates an F1AP gNB-DU Configuration Update procedure from which the IAB-donor-CU can
conclude whether the existing inner IP address(es) (e.g. for SCTP association) and the DL F-TEID can be
reused.
If new TNL addresses for F1-C traffic are configured, new SCTP association(s) between the migrating IAB-node
and the IAB-donor-CU may be established using the new TNL address information of the migrating IAB-node.
The migrating IAB-node sends an F1AP gNB-DU CONFIGURATION UPDATE message to the IAB-donor-
CU, which may include new (outer) IP addresses and corresponding new (inner) IP address for the F1-U traffic
to be switched to the target path.
13. The IAB-donor-CU sends a UE CONTEXT RELEASE COMMAND message to the source parent node IAB-
DU.
14. The source parent node IAB-DU releases the migrating IAB-MT’s context and responds to the IAB-donor-CU
with a UE CONTEXT RELEASE COMPLETE message.
15. The IAB-donor-CU releases BH RLC channels and BAP-sublayer routing entries on the source path between
source parent IAB-node and source IAB-donor-DU.
NOTE:
 In case that the source path and target path have common nodes, the BH RLC channels and BAP-sublayer
routing entries of those nodes may not need to be released in Step 15.
Steps 11, 12 and 15 should also be performed for the migrating IAB-node’s descendant nodes, as follows:
The IAB-donor-CU may allocate new TNL address(es) that is (are) routable via the target IAB-donor-DU to
the descendent nodes via RRCReconfiguration message.
If needed, the IAB-donor-CU may also provide a new default UL mapping which includes a default BH RLC
channel and a default BAP Routing ID for UL F1-C/non-F1 traffic on the target path, to the descendant nodes
via RRCReconfiguration message.
If needed, the IAB-donor-CU configures BH RLC channels, BAP-sublayer routing entries and BH RLC
channel mappings on the target path for the descendant nodes in the same manner as described for the
migrating IAB-node in step 11.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 39
 ETSI TS 138 401 V17.6.0 (2023-10)
The descendant nodes switch their F1-C connections and F1-U tunnels to new TNL addresses that are
anchored at the new IAB-donor-DU, in the same manner as described for the migrating IAB-node in step 12.
Based on implementation, these steps can be performed after or in parallel with the handover of the migrating
IAB-node.
To enable performing these steps in parallel, the IAB-donor-CU sends the RRCReconfiguration message
with the new TNL address(es) and the new default BAP configuration to the descendent node while the
migrating IAB-MT is still connected with source parent node, for example, before Step 5. In this case, the UE
CONTEXT MODIFICATION REQUEST message carrying this RRCReconfiguration message includes a
conditional delivery indication for the descendent node’s parent IAB-DU. Based on this indication, the parent
IAB-DU retains the RRCReconfiguration message until the conditions for delivery are met, as specified in
TS 38.473 [4]. The IAB-donor-CU may further configure the BAP-sublayer routing entries on the migrating
IAB-node and the descendant nodes while the migrating IAB-MT is still connected with the source parent
node.
NOTE:
NOTE:
NOTE:
In upstream direction, in-flight packets between the source parent node and the IAB-donor-CU can be
delivered even after the target path is established.
In-flight downlink data in the source path may be discarded, up to implementation via the NR user plane
protocol (TS 38.425 [24]).
The IAB-donor-CU can determine the unsuccessfully transmitted downlink data over the backhaul link by
implementation.",52.png
"Figure 8.2.3.2-1: IAB intra-CU topology adaptation procedure using MCG SRB in EN-DC
","1. The migrating IAB-MT sends an ULInformationTransferMRDC message to the MeNB
2. The MeNB sends RRC TRANSFER message to the IAB-donor-CU.
3. The IAB-donor-CU may send UE CONTEXT MODIFICATION REQUEST message to the source parent node
IAB-DU, to query the latest SCG configuration.
4.The source parent node IAB-DU responds with a UE CONTEXT MODIFICATION RESPONSE message that
includes full configuration information.
5. The IAB-donor-CU sends a UE CONTEXT SETUP REQUEST message to the target parent node IAB-DU, to
create a UE context for migrating IAB-MT and set up one or more bearers. These bearers can be used by the
migrating IAB-MT for its own signalling, and, optionally, data traffic. The UE CONTEXT SETUP REQUEST
message includes CG-ConfigInfo.
6. The target parent node IAB-DU responds to the IAB-donor-CU with a UE CONTEXT SETUP RESPONSE
message.
7. The IAB-donor-CU sends a UE CONTEXT MODIFICATION REQUEST message to the source parent node
IAB-DU, this message includes the Transmission Action Indicator IE, which instructs the source parent node
IAB-DU to stop the data transmission to the migrating IAB-node. The source parent node IAB-DU also sends a
Downlink Data Delivery Status frame to inform the IAB-donor-CU about the unsuccessfully transmitted
downlink data to the migrating IAB-node.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 41
 ETSI TS 138 401 V17.6.0 (2023-10)
8. The source parent node IAB-DU responds to the IAB-donor-CU with a UE CONTEXT MODIFICATION
RESPONSE message.
9. The IAB-donor-CU sends an SGNB MODIFICATION REQUIRED message to the MeNB.
10/11. The MeNB initiated SgNB Modification procedure may be triggered by the SgNB initiated SgNB
Modification procedure (e.g. to provide information such as data forwarding addresses, new SN security key,
measurement gap, etc.).
12. The MeNB and the migrating IAB-MT perform RRC Connection Reconfiguration procedure. The
RRCConnectionReconfiguration message includes information as described for the intra-CU topology adaptation
procedure in SA in clause 8.2.3.1.
13. The MeNB sends an SGNB MODIFICATION CONFIRM message to the IAB-donor-CU.
14. The migrating IAB-MT performs Random Access procedure at the target parent node IAB-DU.
15-19. The remaining steps of the procedure follow the steps 11-15 of the intra-CU topology adaptation procedure in
SA scenario, as defined in clause 8.2.3.1. The main difference is that the RRC message for the migrating IAB-
node, if involved, will be transmitted using the MCG SRB.",53.png
"Figure 8.2.4-1: Example for IAB topology with two redundant paths
","shows an example for an IAB topology, where one IAB-node, referred to as the dual-connecting IAB-
node, has two paths towards the IAB-donor via different IAB-donor-DUs.",54.png
Figure 8.2.4-2: Procedure for establishment of redundant path in IAB topology,". The dual-connecting IAB-MT sends a MeasurementReport message to the first parent node IAB-DU. This report
is based on a Measurement Configuration the dual-connecting IAB-MT received from the IAB-donor-CU
before.
2.The first parent node IAB-DU sends an UL RRC MESSAGE TRANSFER message to the IAB-donor-CU to
convey the received MeasurementReport.
3. The IAB-donor-CU sends the UE CONTEXT SETUP REQUEST message to the second parent node IAB-DU,
to create the UE context for the dual-connecting IAB-MT and to set up one or more bearers. These bearers can
be used by the dual-connecting IAB-MT for its own signalling, and, optionally, data traffic.
4. The second parent node IAB-DU responds to the IAB-donor-CU with a UE CONTEXT SETUP RESPONSE
message.
5.The IAB-donor-CU sends a DL RRC MESSAGE TRANSFER message to the first parent node IAB-DU, which
includes a generated RRCReconfiguration message. The RRCReconfiguration message may contain one or more
TNL address(es) for the dual-connecting IAB-DU, which are anchored at the second-path IAB-donor-DU. The
IAB-donor-CU can proactively obtain these TNL addresses from the second-path IAB-donor-DU. In case IPsec
tunnel mode is used to protect the F1 and non-F1 traffic, the allocated TNL address is the outer IP address. The
TNL address allocation is not necessary if the first and second paths use the same IAB-donor-DU.
6. The first parent node IAB-DU forwards the received RRCReconfiguration message to the dual-connecting IAB-
MT.
7. The dual-connecting IAB-MT responds to the first parent node IAB-DU with an RRCReconfigurationComplete
message.
8. The first parent node IAB-DU sends an UL RRC MESSAGE TRANSFER message to the IAB-donor-CU, to
convey the received RRCReconfigurationComplete message.
9. A Random Access procedure is performed at the second parent node IAB-DU.
10. The IAB-donor-CU configures BH RLC channels and BAP-layer route entries on the second path between dual-
connecting IAB-node and second-path IAB-donor-DU. These configurations may be performed at an earlier
stage, e.g. immediately after step 3.
11. The new TNL addresses allocated in step 5 (if any) are added to the dual-connecting IAB-DU’s F1-C
association(s) with the IAB-donor-CU. The IAB-donor-CU may configure new UL BH information on the
second path for F1AP messages.
If new TNL addresses for F1-C traffic are configured, new SCTP association(s) between the dual-connecting
IAB-node and the IAB-donor-CU may be established using the new TNL address information of the dual-
connecting IAB-node. The dual-connecting IAB-node sends an F1AP gNB-DU CONFIGURATION UPDATE
message to the IAB-donor-CU, which may include new (outer) IP addresses and corresponding new (inner) IP
address for the F1-U traffic to be switched to the target path.
12. The IAB-donor-CU may migrate the F1-U tunnels it has with the dual-connecting IAB-DU from the first path to
the second path via the UE CONTEXT MODIFICATION REQUEST message.
13. The dual-connectivity IAB-DU replies with a UE CONTEXT MODIFICATION RESPONSE message.
Steps 12 and 13 can be performed for a subset of UE bearers, e.g., to balance the load between the first and the second
path.
In case the second path is used for the dual-connecting IAB-node’s descendant node(s), Steps 10 and 11 are also
performed for the descendant node(s), as follows:
When the second path uses a different IAB-donor-DU, the IAB-donor-CU shall configure the descendent IAB-
DU(s) with one or more new TNL addresses, which are anchored on the IAB-donor-DU of the second path.
If needed, the IAB-donor-CU configures BH RLC channels, BAP-layer route entries on the target path for the
descendant nodes and the BH RLC channel mappings on the descendant nodes in the same manner as
described for the dual-connecting IAB-node in step 10.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 44
 ETSI TS 138 401 V17.6.0 (2023-10)
The descendant nodes’ new TNL addresses (if any) are added to the descendant node IAB-DU’s F1-C
association(s) with the IAB-donor-CU. The IAB-donor-CU may configure UL BH information for the second
path to carry F1AP messages.
The IAB-donor-CU may migrate the F1-U tunnels it has with the dual-connecting IAB-node’s descendant
node(s) from the first path to the second path, as described for step 12.
Based on implementation, these steps can be performed after or in parallel with the redundant path addition of
the dual connecting IAB-node.",55.png
"Figure 8.2.5-1: IAB intra-CU backhaul RLF recovery procedure for an IAB-node in SA mode
"," shows an example of the BH RLF recovery procedure for an IAB-node in SA mode. In this example, the
IAB-node changes from its initial parent node to a new parent node, where the new parent node is served by an IAB-
donor-DU different than the one serving its initial parent node.1. The IAB-MT declares BH RLF for the MCG as described in TS 38.331 [23], clause 5.3.10.3.
2. The IAB-MT undergoing recovery from RLF conducts the RRC re-establishment procedure at the new parent
node, as defined in clause 8.7. In this procedure, the IAB-donor-CU may provide new TNL address(es), which
is(are) anchored at the new IAB-donor-DU, to the IAB-MT via RRC signalling. Furthermore, the IAB-donor-CU
may also provide a new default UL mapping which includes a default BH RLC channel and a default BAP
Routing ID for UL F1-C/non-F1 traffic on the target path, to the IAB-node undergoing recovery from RLF via
RRCReconfiguration message in this procedure.
3.The remaining part of the procedure follows the steps 11-15 of the intra-CU topology adaptation procedure
defined in clause 8.2.3.1.",56.png
Figure 8.3.1-1: Procedure for centralized retransmission in intra gNB-CU scenarios,"This mechanism allows to perform the retransmission of the PDCP PDUs that are not delivered by a gNB-DU (gNB-
DU1) because the corresponding radio links toward the UE are subject to outage. When such outage occurs, the gNB-
DU affected by outage informs the gNB-CU of such event. The gNB-CU can switch transmission of data traffic, as well
as perform retransmission of undelivered PDCP PDUs, from the gNB-DU affected by outage to other available gNB-
DUs (e.g. gNB-DU2 in Figure 8.3.1-1) with a well-functioning radio link toward the UE. The mechanism is also
applicable in EN-DC and MR-DC with 5GC, refer to TS 37.340 [12 The mechanism is shown in Figure 8.3.1-1 and targets the multi-connectivity scenario, where a UE is served by
multiple data radio bearers established at least on two gNB-DUs, and it includes the following steps:
0. The UE is connected and can transmit/receive data to/from gNB-DU1 and gNB-DU2.
1. gNB-DU1 realizes that the radio link towards the UE is experiencing outage.
2. gNB-DU1 sends the ""Radio Link Outage"" notification message to the gNB-CU over the F1-U interface, as part
of the DDDS PDU of the concerned data radio bearer. The message may include information to be used by the
gNB-CU to perform retransmission of the PDCP PDUs that were not delivered by the gNB-DU1 (e.g. the highest
transmitted NR PDCP Sequence Number, the highest successfully delivered NR PDCP Sequence Number and
the lost NR-U Sequence Numbers).
3. gNB-CU decides to switch data traffic transmission and retransmission of PDCP PDUs that were undelivered in
gNB-DU1 via gNB-DU2. gNB-CU stops sending downlink traffic to gNB-DU1. The radio leg between gNB-
DU1 and the UE is not necessarily removed.
4. gNB-CU starts sending traffic (namely new PDUs and potentially retransmitted PDUs) to gNB-DU2.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 46
 ETSI TS 138 401 V17.6.0 (2023-10)
5. If gNB-DU1 realizes that the radio link of the concerned data radio bearer is back in normal operation, it may
send a ""Radio Link Resume"" notification message as part of the DDDS PDU over the F1-U interface to inform
the gNB-CU that the radio link can be used again for the concerned data radio bearer.
6. gNB-CU may start sending traffic (namely new PDUs and potentially retransmitted PDUs) of the concerned data
radio bearer via gNB-DU1 again.",57.png
Figure 8.4.1.1-1: SgNB addition procedure in EN-DC," gives the SgNB addition procedure in EN-DC given that en-gNB consists of gNB-CU and gNB-DU(s), as
shown in Figure 8.4.1.1-1.1~8: refer to TS 37.340 [12].
a1. After receiving the SGNB ADDITION REQUEST message from MeNB, the gNB-CU sends the UE CONTEXT
SETUP REQUEST message to the gNB-DU to create a UE context. As specified in TS 37.340 [12], in the course of
a Secondary Node Change, the UE CONTEXT SETUP REQUEST message may contain source cell group
configuration to allow gNB-DU to perform delta configuration.
a2. The gNB-DU responds to the gNB-CU with the UE CONTEXT SETUP RESPONSE message. In case the gNB-DU
receives the UE CONTEXT SETUP REQUEST message without the source cell group configuration or in the course of
a Secondary Node Change as specified in TS 37.340 [12] or if the gNB-DU decides to perform full configuration after
receiving the source cell group configuration, it shall perform full configuration and indicate that it has applied full
configuration in the UE CONTEXT SETUP RESPONSE message.
NOTE:
On Inter-gNB-CU Mobility, same method is performed to achieve full configuration and delta
configuration.",58.png
Figure 8.4.2.1-1 SgNB release procedure in EN-DC (MN initiated),"the SgNB release procedure in EN-DC given that the en-gNB consists of a gNB-CU and gNB-DU(s).
MN initiated SN Release 1~8: refer to TS 37.340 [12].
NOTE:
 The timing of sending the Step 2 SGNB RELEASE REQUEST ACKNOWLEDGE message is an
example, it may be sent e.g. after step a1 or after a2 and it is up to implementation.
a1. After receiving SGNB RELEASE REQUEST message from MeNB, gNB-CU sends the UE CONTEXT
MODIFICATION REQUEST message to gNB-DU to stop the data transmission for the UE. It is up to gNB-DU
implementation when to stop the UE scheduling.
a2. gNB-DU responds to gNB-CU with UE CONTEXT MODIFICATION RESPONSE message.
a3. After receiving the UE CONTEXT RELEASE message from MeNB, the gNB-CU sends the UE CONTEXT
RELEASE COMMAND message to the gNB-DU to release the UE context.
a4. The gNB-DU responds to the gNB-CU with the UE CONTEXT RELEASE COMPLETE message.",59.png
Figure 8.4.3-1: SCG Suspend/Resume in RRC_INACTIVE,"1. The CU of SN sends the UE CONTEXT MODIFICATION REQUEST message to the DU of SN to suspend the SCG
of the UE before the UE enters into RRC_INACTIVE state from RRC_CONNECTED state.
2. The DU of SN sends the UE CONTEXT MODIFICATION RESPONSE to the CU of SN, and keeps all lower layer
configuration for UEs without transmitting or receiving data from UE.
3~4: refer to TS 37.340 [12].
5. The CU of SN sends the UE CONTEXT MODIFICATION REQUEST message to the DU of SN to resume the SCG
of the UE before the UE enters into RRC_CONNECTED state from RRC_INACTIVE state.
6. The DU of SN sends the UE CONTEXT MODIFICATION RESPONSE message to the CU of SN, and uses the
previously stored lower layer configuration for the UE.
7~11: refer to TS 37.340 [12].",60.png
Figure 8.4.4.1-1: SCG Activation or Deactivation in SN Addition procedure," The MN sends the SN Addition Request message to the SN, indicates the request of SCG activation or
deactivation.
2. The SN-CU-CP may send the BEARER CONTEXT SETUP REQUEST message to the SN-CU-UP to setup
bearer context and notify the activation or deactivation of the SCG.
3. The SN-CU-UP sends the BEARER CONTEXT SETUP RESPONSE message to the SN-CU-CP.
4. The SN-CU sends the UE CONTEXT SETUP REQUEST message to the SN-DU to setup UE context and
indicate the request of SCG activation or deactivation.
5. The SN-DU sends the UE CONTEXT SETUP RESPONSE message to the SN-CU, indicates the SCG status. In
case SCG activation is requested, the SN-DU shall indicate SCG activated in the message.
6. The SN-CU-CP may send the BEARER CONTEXT MODIFICATION REQUEST message to the SN-CU-UP as
described in clause 8.9.2 and may notify the SCG status if needed.
7. The SN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the SN-CU-CP.
8. The SN sends the SN Addition Request Acknowledge message to the MN, indicates the SCG status. In case SCG
activation is requested, the SN shall indicate SCG activated in the message.
9. The MN-CU-CP may send the BEARER CONTEXT MODIFICATION REQUEST message to the MN-CU-UP
to notify the SCG status.
10. The MN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the MN-CU-CP.",61.png
Figure 8.4.4.2-1: SCG Activation or Deactivation in MN initiated SN Modification procedure,"1. SCG is deactivated or activated.
2. The MN sends the SN Modification Request message to the SN, indicates the request of SCG activation or
deactivation.
3. The SN-CU-CP may send the BEARER CONTEXT MODIFICATION REQUEST message to the SN-CU-UP to
notify the SCG activation or deactivation.
4. The SN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the SN-CU-CP.
5. The SN-CU sends the UE CONTEXT MODIFICATION REQUEST message to the SN-DU to indicate the
request of SCG activation or deactivation.
6. The SN-DU may send the UE CONTEXT MODIFICATION RESPONSE message to the SN-CU, indicates the
SCG status.
7. The SN-CU-CP sends the BEARER CONTEXT MODIFICATION REQUEST message to the SN-CU-UP to
notify the SCG status.
8. The SN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the SN-CU-CP.
NOTE: Step 7 and 8 may be skipped in case the SN-DU accepted the SCG activation or deactivation request.
9. The SN sends the SN Modification Request Acknowledge message towards the MN, indicates the SCG status.
10. The MN-CU-CP may send the BEARER CONTEXT MODIFICATION REQUEST message to the MN-CU-UP
to notify the SCG status.
11. The MN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the MN-CU-CP.",62.png
Figure 8.4.4.3-1: SCG Activation or Deactivation in SN initiated SN Modification procedure,"1. SCG is deactivated or activated.
2. The SN-CU-CP may send the BEARER CONTEXT MODIFICATION REQUEST message to the SN-CU-UP to
notify the SCG activation or deactivation.
3. The SN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the SN-CU-CP.
4. The SN-CU sends the UE CONTEXT MODIFICATION REQUEST message to the SN-DU to indicate the
request of SCG activation or deactivation.
5. The SN-DU sends the UE CONTEXT MODIFICATION RESPONSE message to the SN-CU, indicates the SCG
status.
6. The SN-CU-CP may send the BEARER CONTEXT MODIFICATION REQUEST message to the SN-CU-UP to
notify the SCG status.
7. The SN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the SN-CU-CP.
NOTE 1: Step 6 and 7 may be skipped in case the SN-DU accepted the SCG activation or deactivation request.
8. The SN sends the SN Modification Required message to the MN, indicates the request of SCG activation or
deactivation.
9. The MN-CU-CP may send the BEARER CONTEXT MODIFICATION REQUEST message to the MN-CU-UP
to notify the SCG status.
10. The MN-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the MN-CU-CP.
NOTE 2: Based on implementation, step 9 and 10 can be performed after step 11.
11. The MN sends the SN Modification Confirm message to the SN.
NOTE 3: Step 8-11 are not performed in case the SN-DU rejected the SCG activation or deactivation request.",63.png
"Figure 8.5-1: F1 startup and cell activation
","0. The gNB-DU and its cells are configured by OAM in the F1 pre-operational state. The gNB-DU has TNL
connectivity toward the gNB-CU.
1. The gNB-DU sends an F1 SETUP REQUEST message to the gNB-CU including a list of cells that are configured
and ready to be activated. For each cell supporting NPN the gNB-DU includes NPN specific information.
2. In NG-RAN, the gNB-CU ensures the connectivity toward the core network. For this reason, the gNB-CU may
initiate either the NG Setup or the gNB Configuration Update procedure towards 5GC.
3. The gNB-CU sends an F1 SETUP RESPONSE message to the gNB-DU that optionally includes a list of cells to
be activated. The cells in the list of cells to be activated in F1 SETUP RESPONSE message become active,
while the cells not in the list are inactive. The cells that are active are Out-of-Service until the gNB-DU indicates
that they are In-Service . The gNB-DU will initiate the gNB-DU Configuration Update procedure towards the
gNB-CU and includes the cell(s) that are In-Service and/or the cell(s) that are Out-Of-Service. The gNB-DU
may also indicate cell(s) to be deleted, in which case the gNB-CU removes the corresponding cell(s)
information.
4. The gNB-CU may send a GNB CU CONFIGURATION UPDATE message to the gNB-DU that optionally
includes a list of cells to be activated, e.g., in case that these cells were not activated using the F1 SETUP
RESPONSE message.
5. The gNB-DU replies with a GNB CU CONFIGURATION UPDATE ACKNOWLEDGE message that optionally
includes a list of cells that failed to be activated. The gNB-CU regards all Active cells as Out-Of-Service until
the gNB-DU indicates that they are In-Service.
6. The gNB-CU may initiate either the Xn Setup towards a neighbour NG-RAN node or the EN-DC X2 Setup
procedure towards a neighbour eNB.
NOTE 1: For NG-RAN in case that the F1 SETUP RESPONSE message is not used to activate any cell, step 2 may
be performed after step 3.
Over the F1 interface between a gNB-CU and a gNB-DU pair, the following two Cell States are possible:
-
 Inactive: the cell is known by both the gNB-DU and the gNB-CU. The cell shall not serve UEs;
-
Active: the cell is known by both the gNB-DU and the gNB-CU. The cell should try to provide services to the
UEs.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 54
 ETSI TS 138 401 V17.6.0 (2023-10)
The gNB-CU decides whether the Cell State should be “Inactive“ or “Active“. The gNB-CU can request the gNB-DU
to change the Cell State using the F1 SETUP RESPONSE, theGNB DU CONFIGURATION UPDATE
ACKNOWLEDGE, or the GNB CU CONFIGURATION UPDATE messages.
The gNB-DU reports to the gNB-CU the Service Status. The Service Status is the state of the radio transmission
over the air. The Service Status is reported by the gNB-DU for cells for which the Cell State is “Active “. The
following Service Status are defined:
-
 In-Service: the cell is operational and able to serve UEs.
-
 Out-Of-Service: the cell is not operational, and it is not able to serve UEs. The gNB-DU is trying to make the cell
operational.
The gNB-DU reports the Service Status using the GNB DU CONFIGURATION UPDATE message.
NOTE 2: If gNB-DU regards that one or more cells cannot become operational, the gNB-DU deletes them and
reports them using the GNB DU CONFIGURATION UPDATE message.",64.png
"Figure 8.6.1-1: RRC connected to RRC inactive state transition procedure
","e RRC connected to RRC inactive state transition given that gNB consists of gNB-CU and gNB-
DU(s), as shown in Figure 8.6.1-1.0. At first, the gNB-CU determines the UE to enter into RRC inactive mode from connected mode.
1. The gNB-CU generates RRCRelease message which includes suspend configuration towards UE. The RRC
message is encapsulated in UE CONTEXT RELEASE COMMAND message to the gNB-DU.
2. The gNB-DU forwards RRCRelease message to UE.
3. The gNB-DU responds with UE CONTEXT RELEASE COMPLETE message.",65.png
"Figure 8.6.2-1: RRC inactive to other RRC states transition procedure
","1. If data is received from 5GC, the gNB-CU sends PAGING message to the gNB-DU.
2. The gNB-DU sends Paging message to UE.
NOTE:
 Step 1 and 2 only exist in case of DL data arrival.
3. The UE sends RRCResumeRequest message either upon RAN-based paging, UL data arrival or RNA update.
4. The gNB-DU includes RRCResumeRequest in a non-UE associated INITIAL UL RRC MESSAGE TRANSFER
message and transfer to the gNB-CU.
5. For UE Inactive to UE Active transitions, excluding transitions due to signalling exchange only, the gNB-CU
allocates gNB-CU UE F1AP ID and sends UE CONTEXT SETUP REQUEST message to gNB-DU, which may
include SRB ID(s) and DRB ID(s) to be setup, CellGroupConfig stored in gNB-CU or retrieved from the old
NG-RAN node may also be included. In case of NG-RAN sharing, the gNB-CU includes the serving PLMN ID
(in case of SNPNs the serving NID).
6. The gNB-DU responds with UE CONTEXT SETUP RESPONSE message, which contains RLC/MAC/PHY
configuration of SRB and DRBs provided by the gNB-DU.
NOTE:
 Step 5 and step 6 exist for inactive to active transitions, excluding transitions due to signalling exchange
only. When gNB-CU successfully retrieves and verifies the UE context, it may decide to let the UE enter
into RRC active mode. gNB-CU shall trigger UE context setup procedure between gNB-CU and gNB-
DU, during which both SRB1, SRB2 and DRB(s) can be setup. For signalling exchange only transitions,
gNB-CU does not trigger UE Context Setup procedure. For inactive to Idle transitions the gNB-CU does
not trigger the UE Context Setup procedure.
7. The gNB-CU generates RRCResume/RRCSetup/RRCReject/RRCRelease message or receives RRCRelease
message from the old NG-RAN node towards the UE. The RRC message is encapsulated in DL RRC
MESSAGE TRANSFER message together with SRB ID.
8. The gNB-DU forwards RRC message to the UE either over SRB0 or SRB1 as indicated by the SRB ID.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 56
 ETSI TS 138 401 V17.6.0 (2023-10)
NOTE:
In step 7, it is expected that gNB-CU takes appropriate action, e.g. generates RRC resume message for
inactive to active state transition(for both cases of signaling exchange only, and UP data exchange),
generates RRCSetup message for fallback to establish a new RRC connection, and generates or receives
from the old NG-RAN node either RRCRelease message without suspend configuration for inactive to
idle state transition, or RRCRelease message with suspend configuration to remain in inactive state.
If step 5 and 6 are not performed, the gNB-DU deduces the SRB on which to deliver the RRC message in
step 7 from the SRB ID, i.e. SRB ID “0” corresponds to SRB0, SRB ID “1” corresponds to SRB1.
9. The UE sends RRCResumeComplete/RRCSetupComplete message to the gNB-DU.
10. The gNB-DU encapsulates RRC in UL RRC MESSAGE TRANSFER message and send to the gNB-CU.
NOTE:
Step 9 and step 10 exist for inactive to active state transition (for both cases of signaling exchange only,
and UP data exchange). UE generates RRCResumeComplete/RRCSetupComplete message for resume the
existing RRC connection or fallback to a new RRC connection respectively.",66.png
Figure 8.7-1: RRC connection reestablishment procedure,"1. The UE sends a preamble to the gNB-DU.
2. The gNB-DU allocates new C-RNTI and responds with RAR.
3. The UE sends an RRCReestablishmentRequest message to the gNB-DU, which contains old C-RNTI and old
PCI.
4.The gNB-DU includes the RRC message and, if the UE is admitted, the corresponding low layer configuration
for the UE in the INITIAL UL RRC MESSAGE TRANSFER message and transfers to the gNB-CU. The
INITIAL UL RRC MESSAGE TRANSFER message includes the new C-RNTI. If the gNB-DU identifies the
UE as a Reduced Capability UE during the random access procedure, a NR RedCap UE Indication is provided in
the INITIAL UL RRC MESSAGE TRANSFER message.
5.The gNB-CU includes an RRCReestablishment message and transfers to the gNB-DU. If the UE requests to re-
establish RRC connection in the last serving gNB-DU, the DL RRC MESSAGE TRANSFER message shall
include old gNB-DU UE F1AP ID.
6. The gNB-DU retrieves the UE context based on the old gNB-DU UE F1AP ID, and replaces old C-RNTI/PCI
with new C-RNTI/PCI. It sends the RRCReestablishment message to UE.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 58
 ETSI TS 138 401 V17.6.0 (2023-10)
7-8. The UE sends an RRCReestablishmentComplete message to the gNB-DU. The gNB-DU encapsulates the
RRC message in the UL RRC MESSAGE TRANSFER message and sends to the gNB-CU.
9-10. The gNB-CU triggers an UE Context Modification procedure by sending UE CONTEXT MODIFICATION
REQUEST message, which may include DRBs to be modified and released list. The gNB-DU responses with the
UE CONTEXT MODIFICATION RESPONSE message.
9'-10'. The gNB-DU triggers an UE Context Modification procedure by sending UE CONTEXT MODIFICIATION
REQUIRED message, which may include DRBs to be modified and released list. The gNB-CU responses with
UE CONTEXT MODIFICATION CONFIRM message.
NOTE:
 Here it is assumed that the UE accessed the original gNB-DU where the UE context is available for that
UE, and either steps 9-10 or steps 9’-10’ may be executed or both could be skipped.
NOTE:
 If the UE accessed from a gNB-DU other than the original one, the gNB-CU should trigger the UE
Context Setup procedure toward this new gNB-DU.
11-12. The gNB-CU includes an RRCReconfiguration message into the DL RRC MESSAGE TRANSFER message
and transfers to the gNB-DU. The gNB-DU forwards it to the UE.
13-14. The UE sends an RRCReconfigurationComplete message to the gNB-DU, and the gNB-DU forwards it to the
gNB-CU.",67.png
"Figure 8.8-1: Managing multiple TNLAs for F1-C.
","The gNB-DU establishes the first TNLA with the gNB-CU using a configured TNL address.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 59
 ETSI TS 138 401 V17.6.0 (2023-10)
NOTE:
The gNB-DU may use different source and/or destination IP end point(s) if the TNL establishment
towards one IP end point fails. How the gNB-DU gets the remote IP end point(s) and its own IP address
are outside the scope of this specification.
2-3. Once the TNLA has been established, the gNB-DU initiates the F1 Setup procedure to exchange application
level configuration data.
4-6. The gNB-CU may add additional TNL Endpoint(s) to be used for F1-C signalling between the gNB-CU and
the gNB-DU pair using the gNB-CU Configuration Update procedure. The gNB-CU Configuration Update
procedure also allows the gNB-CU to request the gNB-DU to modify or release TNLA(s).
7-9. The gNB-DU may add additional TNL association(s) to be used for F1-C signalling using a gNB-CU
endpoint already in use for existing TNL associations between the gNB-CU and the gNB-DU pair. The gNB-DU
CONFIGURATION UPDATE message including the gNB-DU ID shall be the first F1AP message sent on an
additional TNLA of an already setup F1-C interface instance after the TNL association has become operational.
The F1AP UE TNLA binding is a binding between a F1AP UE association and a specific TNL association for a given
UE. After the F1AP UE TNLA binding is created, the gNB-CU can update the UE TNLA binding by sending the F1AP
message for the UE to the gNB-DU via a different TNLA. The gNB-DU shall update the F1AP UE TNLA binding with
the new TNLA. The gNB-DU Configuration Update procedure also allows the gNB-DU to inform the gNB-CU that the
indicated TNLA(s) will be removed by the gNB-DU.",68.png
Figure 8.9.1-1: UE Initial Access procedure involving E1 and F1,"UE Initial Access
The signalling flow for UE Initial access involving E1 and F1 is shown in Figure 8.9.1-1.Steps 1-8 are defined in clause 8.1.
9. The gNB-CU-CP sends the BEARER CONTEXT SETUP REQUEST message to establish the bearer
 context
in the gNB-CU-UP.
10 The gNB-CU-UP sends the BEARER CONTEXT SETUP RESPONSE message to the gNB-CU-CP, including
F1-U UL TEID and transport layer address allocated by the gNB-CU-UP.
Steps 11-13 are defined in clause 8.1.
14. The gNB-CU-CP sends the BEARER CONTEXT MODIFICATION REQUEST message to the gNB-CU-UP,
including F1-U DL TEID and transport layer address allocated by the gNB-DU.
15. The gNB-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message to the gNB-CU-CP.
Steps 16-22 are defined in clause 8.1.
NOTE:
 Steps 14-15 and steps 16-17 can happen in parallel, but both are before step 18.",69.png
"Figure 8.9.2-1: Bearer context setup over F1-U
","0. Bearer context setup (e.g., following an SGNB ADDITION REQUEST message from the MeNB) is triggered in
gNB-CU-CP.
1. The gNB-CU-CP sends a BEARER CONTEXT SETUP REQUEST message containing UL TNL address
information for S1-U or NG-U, and if required, DL TNL address information for X2-U to setup the bearer
context in the gNB-CU-UP. For NG-RAN, the gNB-CU-CP decides flow-to-DRB mapping and sends the
generated SDAP and PDCP configuration to the gNB-CU-UP.
NOTE:
 In case of Conditional Handover or Conditional PSCell Addition/Change, the BEARER CONTEXT
SETUP REQUEST message indicates to ignore the included security context and not to initiate sending
downlink packets until the UE successfully accesses. Up to implementation, the gNB-CU-CP may request
to establish bearer context as if a regular HO was requested.
2. The gNB-CU-UP responds with a BEARER CONTEXT SETUP RESPONSE message containing the UL TNL
address information for F1-U, and DL TNL address information for S1-U or NG-U, and if required, UL TNL
address information for X2-U or Xn-U.
NOTE:
 The indirect data transmission for split bearer through the gNB-CU-UP is not precluded.
3. F1 UE context setup procedure is performed to setup one or more bearers in the gNB-DU.
4. The gNB-CU-CP sends a BEARER CONTEXT MODIFICATION REQUEST message containing the DL TNL
address information for F1-U or Xn-U, and PDCP status.
5. The gNB-CU-UP responds with a BEARER CONTEXT MODIFICATION RESPONSE message.",70.png
Figure 8.9.3.1-1: Bearer context release over F1-U – gNB-CU-CP initiated,"0. Bearer context release (e.g., following an SGNB RELEASE REQUEST message from the MeNB) is triggered in
gNB-CU-CP.
1. The gNB-CU-CP sends a BEARER CONTEXT MODIFICATION REQUEST message to the gNB-CU-UP.
2. The gNB-CU-UP responds with a BEARER CONTEXT MODIFICATION RESPONSE carrying the PDCP
UL/DL status.
3. F1 UE context modification procedure is performed to stop the data transmission for the UE. It is up to gNB-DU
implementation when to stop the UE scheduling.
NOTE: step 1-3 are performed only if the PDCP status of the bearer(s) needs to be preserved e.g., for bearer type
change.
4. The gNB-CU-CP may receive the UE CONTEXT RELEASE message from the MeNB in EN-DC operation as
described in clause 8.4.2.1.
5. and 7. Bearer context release procedure is performed.
6. F1 UE context release procedure is performed to release the UE context in the gNB-DU.",71.png
"Figure 8.9.3.2-1: Bearer context release over F1-U – gNB-CU-UP initiated
","0. Bearer context release is triggered in gNB-CU-UP e.g., due to local failure.
1. The gNB-CU-UP sends a BEARER CONTEXT RELEASE REQUEST message to request the release of the
bearer context in the gNB-CU-UP. This message may contain the PDCP status.
2.- 5. If the PDCP status needs to be preserved, the E1 Bearer Context Modification and the F1 UE Context
Modification procedures are performed. The E1 Bearer Context Modification procedure is used to convey data
forwarding information to the gNB-CU-UP. The gNB-CU-CP may receive the UE Context Release from the
MeNB.
6. The gNB-CU-CP sends a BEARER CONTEXT RELEASE COMMAND message to release the bearer context in
the gNB-CU-UP.
7. The gNB-CU-UP responds with a BEARER CONTEXT RELEASE COMPLETE to confirm the release of the
bearer context including also data forwarding information.
8. F1 UE context release procedure may be performed to release the UE context in the gNB-DU.",72.png
"Figure 8.9.4-1: Inter-gNB handover involving gNB-CU-UP change
","1. The source gNB-CU-CP sends HANDOVER REQUEST message to the target gNB-CU-CP. In case of
Conditional Handover, the target gNB is regarded as a candidate gNB which is only accessed by the UE when
the CHO condition(s) are fulfilled.
2-4.
 Bearer Context Setup procedure is performed as described in clause 8.9.2.
5. The target gNB-CU-CP responds the source gNB-CU-CP with an HANDOVER REQUEST ACKNOWLEDGE
message.
NOTE:
 In case of Conditional Handover, it is up to target gNB-CU-CP implementation to make sure that the
EARLY STATUS TRANSFER information is forwarded to the right gNB-CU-UP (e.g. separate UE-
associated signalling connection over Xn interface for each gNB-CU-UP).
6. The F1 UE Context Modification procedure is performed to send the handover command to the UE, and to
indicate to stop the data transmission for the UE.
NOTE:
 In case of DAPS Handover or Conditional Handover, the F1 UE Context Modification procedure in step 6
does not indicate to stop the data transmission for the UE. Instead, the F1 DL RRC Message Transfer
procedure can be used which carries the handover command to the UE.
7-8. Bearer Context Modification procedure (gNB-CU-CP initiated) is performed to enable the gNB-CU-CP to
retrieve the PDCP UL/DL status and to exchange data forwarding information for the bearer.
9. The source gNB-CU-CP sends an SN STATUS TRANSFER message to the target gNB-CU-CP.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 65
 ETSI TS 138 401 V17.6.0 (2023-10)
NOTE:
In case of DAPS Handover, the EARLY STATUS TRANSFER message is sent for DRBs configured
with DAPS instead of the SN STATUS TRANSFER message.
NOTE:
In case of Conditional Handover, the EARLY STATUS TRANSFER message is sent only if early data
forwarding is applied.
NOTE:
The COUNT related info for the EARLY STATUS TRANSFER message is retrieved from the source
gNB-CU-UP via the steps 7/8.
10-11. Bearer Context Modification procedure is performed as described in clause 8.9.2. The target gNB-CU-CP
does not transfer the PDCP UL/DL status carried from the SN STATUS TRANSFER message to the target gNB-
CU-UP if the PDCP status does not need to be preserved (e.g. full configuration). In case of DAPS Handover or
Conditional Handover, the COUNT related info carried by the EARLY STATUS TRANSFER message is
provided to the target gNB-CU-UP.
12. Data Forwarding may be performed from the source gNB-CU-UP to the target gNB-CU-UP.
NOTE:
In case of Conditional Handover, the UE performs RACH when the CHO condition(s) are fulfilled. Once
successfully accessed, the target gNB-DU sends an ACCESS SUCCESS message to inform the target
gNB-CU-CP of which cell the UE has accessed through. The target gNB-CU-CP may forward to the
target gNB-CU-UP, necessary information for sending downlink packets (i.e. DL TNL address
information for F1-U and UP security information corresponding to the accessed cell), via a Bearer
context modification procedure. The target gNB-CU-CP may initiate Bearer context release procedure
toward the other signalling connections or other candidate target gNB-CU-UPs, if any, to release the
prepared conditional handover resources for the UE.
12a. In case of DAPS Handover or Conditional Handover, the target gNB-CU-CP sends the HANDOVER
SUCCESS message to the source gNB-CU-CP to inform that the UE has successfully accessed the target cell.
12b In case of DAPS Handover or Conditional Handover, the F1 UE Context Modification procedure is
performed to indicate to stop the data transmission for the UE.
12c-12d. In case of DAPS Handover or Conditional Handover, the Bearer context modification procedure (gNB-
CU-CP initiated) is performed to indicate the source gNB-CU-UP to stop packet delivery and also to retrieve the
PDCP UL/DL status.
12e. In case of DAPS Handover or Conditional Handover, the source gNB-CU-CP sends the SN STATUS
TRANSFER message to the target gNB-CU-CP.
12f-12g. In case of DAPS Handover or Conditional Handover, the Bearer context modification procedure is
performed to provide the PDCP UL/DL status to the target gNB-CU-UP only if the PDCP status needs to be
preserved as described in TS 38.300 [2].
NOTE:
 In case of Conditional Handover, inactivity monitoring is performed after step 12g.
13-15. Path Switch procedure is performed to update the DL TNL address information for the NG-U towards the
core network.
16. The target gNB-CU-CP sends an UE CONTEXT RELEASE message to the source gNB-CU-CP.
17. and 19. Bearer Context Release procedure is performed.
18. F1 UE Context Release procedure is performed to release the UE context in the source gNB-DU.",73.png
"Figure 8.9.5-1: Change of gNB-CU-UP
","1. Change of gNB-CU-UP is triggered in gNB-CU-CP based on e.g., measurement report from the UE.
2-3.
 Bearer Context Setup procedure is performed as described in clause 8.9.2.
4. F1 UE Context Modification procedure is performed to change the UL TNL address information for F1-U for
one or more bearers in the gNB-DU.
5-6. Bearer Context Modification procedure (gNB-CU-CP initiated) is performed to enable the gNB-CU-CP to
retrieve the PDCP UL/DL status and to exchange data forwarding information for the bearer.
7-8.
 Bearer Context Modification procedure is performed as described in clause 8.9.2.
9. Data Forwarding may be performed from the source gNB-CU-UP to the target gNB-CU-UP.
10-12. PDU Session Resource Modify Indication procedure is performed to update the DL TNL address information
for the NG-U towards the core network.
13-14. Bearer Context Release procedure (gNB-CU-CP initiated) is performed as described in clause 8.9.3.",74.png
Figure 8.9.6.1-1: RRC Connected to RRC Inactive state transition.,"1. The gNB-CU-CP sends BEARER CONTEXT SETUP REQUEST message with UE/PDU session/DRB level
inactivity timer.
2. The gNB-CU-UP sends BEARER CONTEXT SETUP RESPONSE message.
3. The gNB-CU-UP sends BEARER CONTEXT INACTIVITY NOTIFICATION message with inactivity
monitoring results.
4. The gNB-CU-CP determines that the UE should enter RRC-inactive (e.g., after receiving Bearer Context
Inactivity Notification procedure).
5. The gNB-CU-CP sends BEARER CONTEXT MODIFICATION REQUEST message with a Bearer Context
Status Change to the gNB-CU-UP, which indicates that the UE is entering RRC-inactive state. The gNB-CU-CP
keeps the F1 UL TEIDs.
6. The gNB-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE message including the PDCP
UL and DL status that may be needed for e.g., data volume reporting. The gNB-CU-UP keeps the Bearer
Context, the UE-associated logical E1-connection, the NG-U related resource (e.g., NG-U DL TEIDs) and the
F1 UL TEIDs.
7. The gNB-CU-CP sends the UE CONTEXT RELEASE COMMAND message to the gNB-DU serving the UE,
together with the RRCRelease message to be sent to the UE.
NOTE: step 5 and step 7 can be performed at the same time.
8. The gNB-DU sends the RRCRelease message to the UE.
9. The gNB-DU sends the UE CONTEXT RELEASE COMPLETE message to the gNB-CU-CP.",75.png
"Figure 8.9.6.2-1: RRC Inactive to RRC Connected state transition.
","0. The gNB-CU-UP receives DL data on NG-U interface.
1. The gNB-CU-UP sends DL DATA NOTIFICATION message to the gNB-CU-CP.
2. The gNB-CU-CP sends PAGING message to the gNB-DU.
3. The gNB-DU sends the Paging message to the UE.
NOTE: steps 0-3 are needed only in case of DL data.
4. The UE sends RRCResumeRequest message either upon RAN paging or UL data arrival.
5. The gNB-DU sends the INITIAL UL RRC MESSAGE TRANSFER message to the gNB-CU-CP.
6. The gNB-CU-CP sends UE CONTEXT SETUP REQUEST message including the stored F1 UL TEIDs to create
the UE context in the gNB-DU.
7. The gNB-DU responds with the UE CONTEXT SETUP RESPONSE message including the F1 DL TEIDs
allocated for the DRBs.
8. The gNB-CU-CP and the UE perform the RRC-Resume procedure via the gNB-DU.
9. The gNB-CU-CP sends BEARER CONTEXT MODIFICATION REQUEST message with a RRC Resume
indication, which indicates that the UE is resuming from RRC-inactive state. The gNB-CU-CP also includes the
F1 DL TEIDs received from the gNB-DU in step 7.
10. The gNB-CU-UP responds with theBEARER CONTEXT MODIFICATION RESPONSE message.
NOTE steps 8 and 9 can be performed in parallel.",76.png
Figure 8.9.6-1: Trace activation/deactivation over F1 and E1," The gNB-CU-CP receives a TRACE START message from the AMF or the MeNB (in case of EN-DC).
2. The gNB-CU-CP initiates the Trace Start procedure by sending a TRACE START message to the gNB-DU, the
gNB-CU-UP or both.
3. Upon reception of the TRACE START message, the gNB-DU, the gNB-CU-UP or both initiate the requested
trace session and report it as described in TS 32.422 [20].
4. The gNB-CU-CP receives a DEACTIVATE TRACE message from the AMF or the MeNB (in case of EN-DC).
5. The gNB-CU-CP initiates the Deactivate Trace procedure by sending a DEACTIVATE TRACE message to the
gNB-DU, the gNB-CU-UP or both.
6. Upon reception of the DEACTIVATE TRACE message, the gNB-DU, the gNB-CU-UP or both stop the trace
session for the indicated trace reference.",77.png
Figure 8.9.8-1: Signalling flow for IAB BH RLC channel establishment procedure,"1. The IAB-donor-CU sends to the IAB-donor-DU a UE CONTEXT MODIFICATION REQUEST message for
setting up the parent-node IAB-DU side of the BH link between IAB-donor-DU and IAB-node 1. This step is
optional and is required only when a new BH RLC channel needs to be established on the BH link between IAB-
donor-DU and IAB-node 1.
2. The IAB-donor-DU sends the UE CONTEXT MODIFICATION RESPONSE message to the IAB-donor-CU.
3. The IAB-donor-CU sends to the IAB-donor-DU a DL RRC MESSAGE TRANSFER message encapsulating the
RRCReconfiguration message for configuring the IAB-MT of IAB-node 1. This step is optional and is required
only when a new BH RLC channel needs to be established on the BH link between IAB-donor-DU and IAB-
node 1.
4. The IAB-donor-DU decapsulates and forwards the RRCReconfiguration message to the IAB-MT of IAB-node 1.
This step is optional and is required only when a new BH RLC channel needs to be established on the BH link
between IAB-donor-DU and IAB-node 1.
5. The IAB-MT of IAB-node 1 sends to the IAB-donor-DU an RRCReconfigurationComplete message destined to
the IAB-donor-CU. This step is optional and is required only when a new BH RLC channel needs to be
established on the BH link between IAB-donor-DU and IAB-node 1.
6. The IAB-donor-DU sends the UL RRC MESSAGE TRANSFER message encapsulating the
RRCReconfigurationComplete message to the IAB-donor-CU. This step is optional and is required only when a
new BH RLC channel needs to be established on the BH link between IAB-donor-DU and IAB-node 1.
7. The IAB-donor-CU sends to the IAB-DU of IAB-node 1 a UE CONTEXT MODIFICATION REQUEST
message for setting up the parent node IAB-DU side of the BH link between IAB-node 1 and IAB-node 2. This
step is optional and is required only when a new BH RLC channel needs to be established on the BH link
between IAB-node 1 and IAB-node 2.
8. The IAB-node 1 sends the UE CONTEXT MODIFICATION RESPONSE message to the IAB-donor-CU.
9. The IAB-donor-CU sends to the IAB-DU of IAB-node 1 a DL RRC MESSAGE TRANSFER message
encapsulating the RRCReconfiguration message for configuring the IAB-MT of IAB-node 2. This step is
optional and is required only when a new BH RLC channel needs to be established on the BH link between IAB-
node 1 and IAB-node 2.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 71
 ETSI TS 138 401 V17.6.0 (2023-10)
10. The IAB-DU of IAB-node 1 decapsulates and forwards the RRCReconfiguration message to the IAB-MT of
IAB-node 2. This step is optional and is required only when a new BH RLC channel needs to be established on
the BH link between IAB-node 1 and IAB-node 2.
11. The IAB-MT of IAB-node 2 sends to IAB-node 1 an RRCReconfigurationComplete message destined to the
IAB-donor-CU. This step is optional and is required only when a new BH RLC channel needs to be established
on the BH link between IAB-node 1 and IAB-node 2.
12. IAB-node 1 sends the UL RRC MESSAGE TRANSFER message encapsulating the
RRCReconfigurationComplete message to the IAB-donor-CU. This step is optional and is required only when a
new BH RLC channel needs to be established on the BH link between IAB-node 1 and IAB-node 2.",78.png
"Figure 8.10-1: Managing multiple TNLAs for E1.
","1. Either the gNB-CU-CP or gNB-CU-UP establishes the first SCTP association with the gNB-CU-UP or gNB-
CU-CP respectively using a configured TNL address.
NOTE:
The gNB-CU-UP/gNB-CU-CP may use different source and/or destination IP end point(s) if the TNL
establishment towards one IP end point fails. How the gNB-CU-UP/gNB-CU-CP gets the remote IP end
point(s) and its own IP address are outside the scope of this specification.
2-3 (A). Once the TNLA (gNB-CU-UP initiated) has been established, the gNB-CU-UP initiates the E1 Setup
procedure to exchange application level configuration data.
2-3 (B). Once the TNLA (gNB-CU-CP initiated) has been established, the gNB-CU-CP initiates the E1 Setup
procedure to exchange application level configuration data.
4-6. The gNB-CU-CP may add additional SCTP Endpoint(s) to be used for E1 signalling between the gNB-CU-
CP and the gNB-CU-UP pair using the gNB-CU-CP Configuration Update procedure. The gNB-CU-CP
Configuration Update procedure also allows the gNB-CU-CP to request the gNB-CU-UP to modify or release
TNLA(s).
7-9. The gNB-CU-UP may add additional TNL association(s) to be used for E1 signalling using a gNB-CU-CP
endpoint already in use for existing TNL associations between the gNB-CU-CP and the gNB-CU-UP pair. The
gNB-CU-UP CONFIGURATION UPDATE message including the gNB-CU-UP ID shall be the first E1AP
message sent on an additional TNLA of an already setup E1 interface instance after the TNL association has
become operational. The E1AP UE TNLA binding is a binding between a E1AP UE association and a specific
TNL association for a given UE. After the E1AP UE TNLA binding is created, the gNB-CU-CP can update the
UE TNLA binding by sending the E1AP message for the UE to the gNB-CU-UP via a different TNLA. The
gNB-CU-UP shall update the E1AP UE TNLA binding with the new TNLA. The gNB-CU-UP Configuration
Update procedure also allows the gNB-CU-UP to inform the gNB-CU-CP that the indicated TNLA(s) will be
removed by the gNB-CU-UP.",79.png
"Figure 8.11.2-1: UE Initial Access procedure and network sharing with multiple cell-ID broadcast
","In this example message flow
-
 the UE is assumed to not provide an ue-Identity from which the DU is able to deduce the PLMN ID.
-
 each F1-C interface instance uses a separate signalling transport or share signalling transport with other F1-C
interface instances.
-
 the gNB-DUA/B entity shown in Figure 8.11.2-1 is a simplified representation of the gNB-DUA of PLMN A, the
gNB DUB of PLMN B and respective radio resources of the shared cell.6. The gNB-DUA sends the F1AP UE CONTEXT RELEASE REQUEST message to the gNB-CUA. including a
Cause set to ""PLMN not served by the CU"".
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 76
 ETSI TS 138 401 V17.6.0 (2023-10)
7. The gNB-DUB sends the F1AP INITIAL UL RRC MESSAGE to the gNB-CUB. including the NR CGI
associated with PLMNB, the C-RNTI indicated by the gNB-DUA at step 2, and the RRC-Container IE and the
RRC-Container-RRCSetupComplete IE with the RRC message received in step1 and step 5 respectively. The
RRC-Container-RRCSetupComplete IE are included in the INITIAL UL RRC MESSAGE TRANSFER for
the case of network sharing and shall contain the RRC messages received via the RRC UL-DCCH-Message
IE from the UE, but never previously sent to the gNB-CUB.
8. The gNB-CU A sends the UE CONTEXT RELEASE COMMAND message to the gNB-DU.
9. The gNB-DU sends the UE CONTEXT RELEASE COMPLETE message to the gNB-CUA.
NOTE: Initiating procedures from gNB-DUA towards gNB-CUA and from gNB-DUB to gNB-CUB in parallel is not
precluded.",80.png
"Figure 8.11.3-1: RRC Connection Reestablishment and network sharing with multiple cell-ID broadcast
","each F1-C/Xn-C interface instance uses either a separate signalling transport or a share signalling transport with
other interface instances.
-
 the New gNB-DU A/B entity shown in Figure 8.11.3-1 is a simplified representation of the New gNB-DUA of
PLMN A, the New gNB DUB of PLMN B and respective radio resources of the shared cell.1. The UE sends the RRCReestablishmentRequest.
2A-5A. Depicts the case where the UE context could not be retrieved by the new gNB-CUA. In step 2A, the NR
CGI associated to PLMNA is indicated. In step 5A, the gNB-CUA would prepare the possibility to revert back to
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 77
 ETSI TS 138 401 V17.6.0 (2023-10)
normal RRC Connection Establishment, indicating that the UE Context was not retrieveable and may include the
re-directed RRC message as received in step 1. After step 5A, the gNB-DUA may redirect the UE towards the
PLMN indicated in DL RRC MESSAGE TRANSFER message, if the PLMN assistance information is
provided by the gNB-CUA . If the New gNB-DU A/B was not able to deduce the RRC message from step 1, this
indicator triggers step 2B. The New gNB-DUA is supposed to trigger the release the UE-associated signalling
connection (not shown).
2B-5B. Depicts the case where the UE context was retrieveable by the New gNB-CUB. In step 2B, the NR CGI
associated to PLMNB is indicated. Step 2B also includes the C-RNTI allocated at reception of step 1.
6-8.
 The RRC Connection Reestablishment continues with the New gNB-CUB.
NOTE:
 If all gNB-CUs indicate that the UE context is not retrievable, the RRC connection reestablishment falls
back to RRC Connection setup, as described in clause 8.11.2.
NOTE:
 Initiating procedures from gNB-DUA towards gNB-CUA and from gNB-DUB to gNB-CUB in parallel is
not precluded.",81.png
"Figure 8.12.1-1: The integration procedure for IAB-node in SA
","A high-level flow chart for SA-based IAB integration Phase 1: IAB-MT setup. In this phase, the IAB-MT of the new IAB-node (e.g. IAB-node 2 in Figure 8.12.1-1)
connects to the network in the same way as a UE, by performing RRC connection setup procedure with IAB-
donor-CU, authentication with the core network, IAB-node 2-related context management, IAB-node 2’s access
traffic-related radio bearer configuration at the RAN side (SRBs and optionally DRBs), and, optionally, OAM
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 78
 ETSI TS 138 401 V17.6.0 (2023-10)
connectivity establishment by using the IAB-MT’s PDU session. The IAB-node can select the parent node for
access based on an over-the-air indication from potential parent node IAB-DU (transmitted in SIB1). To indicate
its IAB capability, the IAB-MT includes the IAB-node indication in RRCSetupComplete message, to assist the
IAB-donor to select an AMF supporting IAB.
NOTE: The signalling flow for UE initial access procedure as shown in Figure 8.1-1/Figure 8.9.1-1 is used for the
setup of the IAB-MT.
Phase 2-1: BH RLC channel establishment. During the bootstrapping procedure, one default BH RLC channel for
non-UP traffic e.g. carrying F1-C traffic/non-F1 traffic to and from the IAB-node 2 in the integration phase, is
established. This may require the setup of a new BH RLC channel or modification of an existing BH RLC channel
between IAB-node 1 and IAB-donor-DU. The IAB-donor-CU may establish additional (non-default) BH RLC
channels. This phase also includes configuring the BAP Address of the IAB-node 2 and default BAP Routing ID
for the upstream direction.
NOTE: If the OAM connectivity is supported via backhaul IP layer by implementation, one or more BH RLC
channels used for OAM traffic can also be established.
Phase 2-2: Routing update. In this phase, the BAP sublayer is updated to support routing between the new IAB-
node 2 and the IAB-donor-DU. For the downstream direction, the IAB-donor-CU initiates F1AP procedure to
configure the IAB-donor-DU with the mapping from IP header field(s) to the BAP Routing ID related to IAB-
node 2. The routing tables are updated on all ancestor IAB-nodes (e.g. IAB-node 1 in Figure 8.12.1-1) and on the
IAB-donor-DU, with routing entries for the new BAP Routing ID(s). This phase may also include the IP address
allocation procedure for IAB-node 2. IAB-node 2 may request one or more IP addresses from the IAB-donor-CU
via RRC. The IAB-donor-CU may send the IP address(es) to the IAB-node 2 via RRC. The IAB-donor-CU may
obtain the IP address(es) from the IAB-donor-DU via F1-AP or by other means (e.g. OAM, DHCP). IP address
allocation procedure may occur at any time after RRC connection has been established.
Phase 3: IAB-DU part setup. In this phase, the IAB-DU of IAB-node 2 is configured via OAM. The IAB-DU of
IAB-node 2 initiates the TNL establishment, and F1 setup (as defined in clause 8.5) with the IAB-donor-CU using
the allocated IP address(es). The IAB-donor-CU discovers collocation of IAB-MT and IAB-DU from the IAB-
node’s BAP Address included in the F1 SETUP REQUEST message. After the F1 is set up, the IAB-node 2 can
start serving the UEs.",82.png
Figure 8.12.2-1: Signalling flow for IAB integration procedure in NSA,"Phase 1-1. IAB-MT part setup with E-UTRAN. In this phase, the IAB-MT part connects to the LTE network as a
UE, by performing RRC connection setup procedure with an eNB, authentication with the EPC, IAB-node’s access
traffic-related radio bearer configuration at the E-UTRAN side, and optionally, OAM connectivity establishment
by using the IAB-MT’s PDN connection. The IAB-node can select the IAB-supporting eNB based on an over-the-
air indication from eNB (transmitted in SIB1). To indicate its IAB capability, the IAB-MT includes the IAB-node
indication in RRCConnectionSetupComplete message, to assist the eNB to select an MME supporting IAB. The
eNB then configures the IAB-MT part with an NR measurement configuration in order to perform discovery,
measurement and measurement reporting of candidate gNBs. To enable the eNB choose an en-gNB which supports
IAB function, the IAB capability of neighbour gNBs can be pre-configured in the eNB (e.g. by OAM).
NOTE: Other ways to enable the eNB know the IAB capability of neighbour gNBs are not precluded.
Phase 1-2. SgNB addition. In this phase, the IAB-MT part connects to the parent node IAB-DU and IAB-donor-
CU via the EN-DC SgNB Addition procedure. The procedure defined in clause 8.4.1 is reused. The eNB includes
“IAB Node Indication” in SGNB ADDITION REQUEST message to inform the IAB-donor-CU that the request
is for an IAB-node. In addition, SRB3 can be set up for the IAB-MT, to transmit RRC message between the IAB-
MT and the IAB-donor-CU via the NR links directly.
Phase 2-1: BH RLC channel establishment. This phase is the same as Phase 2-1 in the standalone IAB integration
procedure (refer to the Phase 2-1 in clause 8.12.1). This step may occur in Phase 1-2.
Phase 2-2: Routing update. This phase is the same as Phase 2-2 in the standalone IAB integration procedure (refer
to the Phase 2-2 in clause 8.12.1), except that the IP traffic on the F1-C interface may be transmitted via the MeNB.
Phase 3. IAB-DU part setup. This phase is the same as Phase 3 in the standalone IAB integration procedure (refer
to the Phase 3 in clause 8.12.1), except that the IP traffic on the F1-C interface may be transmitted via the MeNB.
The IAB-donor-CU decides to only configure LTE leg, or only to configure NR leg, or to configure both LTE leg
and NR leg, to be used for F1-C traffic transfer. The configuration may be performed before IAB-DU part setup.
IAB-donor-CU may also change the configuration after IAB-DU part setup. In case the configuration is not
performed before IAB-DU part setup, the IAB node uses the NR leg as the default one. When both LTE leg and
NR leg are configured, it is up to the implementation to select the leg for F1-C traffic transfer.",83.png
Figure8.13.1-1 Signalling based MDT Activation,"1. The AMF starts a trace session and sends a TRACE START message to the gNB. The AMF shall consider the
MDT user consent information when activating an MDT trace session for the UE as defined in TS 32.422 [20].
TRACE START message includes the parameters for configuring MDT measurements.
2. The gNB-CU-CP decides if the gNB-CU-UP, or the gNB-DU, or both, should be involved in the MDT
measurement. If the gNB-CU-UP should be involved in the MDT measurement, the gNB-CU-CP sends TRACE
START message to the gNB-CU-UP, including MDT configuration parameters.
3. If the gNB-DU should be involved in the MDT measurement, the gNB-CU-CP sends TRACE START message
to the gNB-DU, including MDT configuration parameters.",84.png
"Figure 8.13.2.2-1
 Management based MDT Activation in gNB-CU-CP","1. The EM sends a Trace Session activation request to the gNB-CU-CP. This request includes the parameters for
configuring UE measurements.
2. The gNB-CU-CP shall select the suitable UEs for MDT data collection. If the UE is not in the specified area or
if the serving PLMN is not within the Management Based MDT PLMN List the UE shall not be selected by the
gNB-CU-CP for MDT data collection as defined in TS 32.422 [20].
3.For each selected UE, if the gNB-CU-UP should perform MDT measurement, the gNB-CU-CP sends TRACE
START message to the gNB-CU-UP, including MDT configuration parameters.
For each selected UE, if the gNB-DU should perform MDT measurement, the gNB-CU-CP sends TRACE
START message to the gNB-DU, including MDT configuration parameters.
4. The gNB-CU-CP may send CELL TRAFFIC TRACE message to the AMF for the selected UE, including Trace
ID for MDT. The AMF forwards Trace ID and other information to the TCE as specified in TS 32.422 [20].",85.png
"Figure 8.13.2.3-1
 Management based MDT Activation in gNB-DU","1. The gNB-CU-CP sends UE CONTEXT SETUP REQUEST message to the gNB-DU, including Management
based MDT PLMN List. The message may include the Polluted Measurement Indicator IE. If the gNB-DU has
received the Polluted Measurement Indicator IE, the gNB-DU includes the information contained in such
indicator as part of the measurement report to be sent to the TCE, so that the TCE is able to correlate and filter
the affected measurements.
2. The gNB-DU sends UE CONTEXT SETUP RESPONSE message to the gNB-CU-CP.
3. The EM sends a Trace Session activation request to the gNB-DU. This request includes the parameters for
configuring UE measurements.
4.The gNB-DU shall select the suitable UEs for MDT data collection. If the UE is not in the specified area or if
the serving PLMN is not within the Management Based MDT PLMN List the UE shall not be selected by the
gNB-DU for MDT data collection as defined in TS 32.422 [20].
For each selected UE, the gNB-DU may send CELL TRAFFIC TRACE message to the gNB-CU-CP in the F1
UE associated signalling, including Trace ID for MDT.
5.Upon reception of a CELL TRAFFIC TRACE message from F1, the gNB-CU-CP shall send CELL TRAFFIC
TRACE message to the AMF for this UE, including Trace ID for MDT. The AMF forwards Trace ID and other
information to the TCE as specified in TS 32.422 [20].",86.png
"Figure 8.13.2.4-1
 Management based MDT Activation in gNB-CU-UP","1.The gNB-CU-CP sends BEARER CONTEXT SETUP REQUEST message to the gNB-CU-UP, including
Management based MDT PLMN List. The message may include Polluted Measurement Indicator. If the gNB-
DU has received the Polluted Measurement Indicator IE, the gNB-DU includes the information contained in
such indicator as part of the measurement report to be sent to the TCE so that the TCE is able to correlate and
filter the affected measurements.
2.3.The gNB-CU-UP sends BEARER CONTEXT SETUP RESPONSE message to the gNB-CU-CP.
The EM sends a Trace Session activation request to the gNB-CU-UP. This request includes the parameters for
configuring UE measurements.
4. The gNB-CU-UP shall select the suitable UEs for MDT data collection. If the serving PLMN is not within the
Management Based MDT PLMN List the UE shall not be selected by the gNB-CU-UP for MDT data collection
as defined in TS 32.422 [20].
For each selected UE, the gNB-CU-UP may send CELL TRAFFIC TRACE message to the gNB-CU-CP in the
E1 UE associated signalling, including Trace ID for MDT
5.Upon reception of a CELL TRAFFIC TRACE message from E1, the gNB-CU-CP shall send CELL TRAFFIC
TRACE message to the AMF for this UE, including Trace ID for MDT. The AMF forwards Trace ID and other
information to the TCE as specified in TS 32.422 [20].",87.png
"Figure 8.13.2.5-1
 User consent propagation in EN-DC","0. User Context information are made available at the MME.
1. The MME sends INITIAL CONTEXT SETUP REQUEST message to the MeNB, including Management Based
MDT Allowed IE and the Management based MDT PLMN List IE to communicate user consent to the eNB.
2. The MeNB sends SGNB ADDITION REQUEST to the gNB-CU-CP at EN-DC setup. This request includes
Management Based MDT Allowed IE and, optionally, the Management based MDT PLMN List IE, if available.
3a. The user consent is communicated to the gNB-DU at the UE context setup by including the Management based
MDT PLMN List IE in the UE CONTEXT SETUP REQUEST.
3b. The user consent is communicated to the gNB-CU-UP at the bearer context setup by including the Management
based MDT PLMN List IE in the BEARER CONTEXT SETUP REQUEST.",88.png
"Figure 8.13.2.6-1
 User consent propagation in NR-DC and NGEN-DC","0. User Context information are made available at the AMF.
1. The AMF sends INITIAL CONTEXT SETUP REQUEST message to the MN, including the Management based
MDT PLMN List IE to communicate user consent to the MN.
2. The MN sends S-NODE ADDITION REQUEST to the SgNB-CU-CP at NR-DC setup. This request includes the
Management based MDT PLMN List IE.
3a. The user consent is communicated to the SgNB-DU at the UE context setup by including the Management based
MDT PLMN List IE in the UE CONTEXT SETUP REQUEST.
3b. The user consent is communicated to the SgNB-CU-UP at the bearer context setup by including the Management
based MDT PLMN List IE in the BEARER CONTEXT SETUP REQUEST.",89.png
"Figure 8.13.2.7-1
 Data anonymization in MR-DC when the SN is the SgNB","0.The gNB-CU-CP, the gNB-CU-UP, the gNB-DU receives the MDT configuration from EM and select the
suitable UEs for MDT data collection. The anonymization MDT configuration parameter from the EM is
considered to be IMEI-TAC.
1. For the management based MDT activation in gNB-CU-UP and/or in gNB-DU, if the gNB-CU-UP and/or the
gNB-DU receive an MDT Configuration including the anonymization parameter set to IMEI-TAC, the gNB-CU-
UP and/or gNB-DU send CELL TRAFFIC TRACE message to the gNB-CU-CP for this UE, including Trace ID
and privacy indicator.
2. For the management based MDT activation in gNB-CU-CP, upon receiving the CELL TRAFFIC TRACE
message from E1/F1, the gNB-CU-CP shall send a CELL TRAFFIC TRACE message to the MN for this UE,
including Trace ID and privacy indicator.
3. The MN sends a CELL TRAFFIC TRACE message to the CN for this UE, including Trace ID and privacy
indicator. The CN forwards Trace ID and other information to the TCE as specified in TS 32.422 [20].",90.png
Figure 8.14.1.1-1 Example of signalling of RLF information from gNB-CU to gNB-DU in NG RAN,"1. A UE with a logged RLF Report connects to a cell in gNB2 and it signals the RLF Report to gNB2 by means of
the RRC UE Information Request/Response procedures.
2. The gNB2 sends an Xn: Failure Indication to gNB1-CU where the UE may have previously been connected prior
to the connection failure. This includes also the RLF Report.
3. The gNB1-CU sends the F1: Access and Mobility Indication message to the gNB1-DU, including the RLF
Report.
It is also possible for the gNB-CU receiving the RLF Report from the UE to signal it directly to the gNB-DU by means
of the F1: Access and Mobility Indication procedure.",91.png
Figure 8.14.1.2-1 Example of signalling of RACH information from gNB-CU to gNB-DU in NG-RAN,"1. A UE with a RACH Report concerning cells of gNB1 connects to a cell in gNB2 and it signals the RACH Report
to gNB2 by means of the RRC UE Information Request/Response procedures.
2. GNB2 sends an Xn: Access and Mobility Indication message to gNB1-CU where the UE may have previously
been connected. This includes also the RACH Report.
3. GNB1-CU sends the F1: Access and Mobility Indication message to the gNB1-DU, including the RACH Report.
It is also possible for the gNB-CU receiving the RACH Report from the UE to signal it directly to the gNB-DU by
means of the F1: Access and Mobility Indication procedure.",92.png
Figure 8.15.1.1-1: Broadcast MBS Session Setup,"1. The 5GC starts the broadcast session by sending the NGAP Broadcast Session Setup Request message to the
gNB containing the TMGI, S-NSSAI, 5G QoS Profile, area information and transport information (for NG-U
multicast transport it provides the IP multicast address and the IP source specific multicast address).
2/3. The gNB-CU-CP sets up the broadcast bearer context, providing NG-U transport information from the 5GC to
the gNB-CU-UP and receiving from the gNB-CU-UP the NG-U GTP DL TEID in case NG-U unicast transport
was selected and an F1-U GTP UL TEID per MRB.
4. In case of NG-U multicast transport, the gNB-CU-UP joins the NG-U multicast group.
5/6. The gNB-CU-CP establishes the Broadcast MBS Session Context at the gNB-DU, providing MRB
configuration, other relevant session parameters and F1-U GTP UL TEID information, and receiving F1-U GTP
DL TEID information.
7/8. The gNB-CU-CP triggers BC Bearer Context Modification Request towards the gNB-CU-UP to provide the
F1-U GTP DL TEID information.
9. The gNB-DU configures broadcast resources and provides broadcast configuration information to the UEs by
means of MCCH.
10. The gNB-CU CP successfully terminates the NGAP broadcast Session Setup procedure. In case the gNB has
chosen NG-U unicast transport, NG-U GTP DL TEID information is provided to the 5GC.
11. The broadcast MBS media stream is provided to the UEs.
On NG-U, in case of location dependent broadcast MBS Sessions, multiple shared NG-U transport tunnels may need to
be setup, one per Area Session ID served by the gNB.
In case of shared NG-U termination,
-
 the gNB-CU-UP may provide the gNB-CU-CP at E1 setup or configuration update about established shared NG-
U terminations, indicated by one or several MBS Session IDs.
-
 at establishment of the BC bearer context in the gNB-CU-UP, the gNB-CU-CP may request the gNB-CU-UP to
either apply the available MRB configuration of the shared NG-U termination, or to apply the MRB
configuration requested by the gNB-CU-CP. The gNB-CU-UP provides the MRB configuration to the gNB-CU-
CP if the MRB configuration requested by the gNB-CU-CP and the available MRB configuration of the shared
NG-U termination are different.",93.png
"Figure 8.15.1.2-1: Multicast MBS Session Context establishment
","0. For a certain multicast MBS session (TMGI), which is currently active, no multicast MBS session context is yet
established in the gNB.
1. The UE joins the multicast session.
NOTE 1: NAS related details for PDU Session signalling are not shown in Figure 8.15.1.2-1.
2/3. The gNB-CU-CP establishes the multicast bearer context at the gNB-CU-UP. For unicast NG-U transport the
GTP DL TEID is retrieved.
4/5. The gNB-CU CP triggers the NGAP Distribution Setup procedure. For unicast NG-U transport, DL GTP TEID
is provided to the 5GC. For multicast NG-U transport, multicast address information is retrieved from the 5GC.
Multicast session QoS parameters are provided by the 5GC.
5a/5b. The gNB-CU-CP triggers the setup of MRB resources via the E1AP MC Bearer Context Modification
procedure. For multicast NG-U transport the 5GC shared NG-U multicast address information is provided to the
gNB-CU-UP. Multicast session QoS parameters are provided to the gNB-CU-UP.
6/7. The gNB-CU-CP establishes the Multicast Context at the gNB-DU, providing MRB configuration. It may
contain MBS Area Session ID information.
8/9. The gNB-CU-CP retrieves the MRB configuration for the joined UE from the gNB-DU via F1 UE Context
Management procedures.
NOTE 2: The interactions between the gNB-CU-CP and gNB-CU-UP for UE specific Berarer Context management
before and after step 8/9 are not illustrated in this Figure.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 91
 ETSI TS 138 401 V17.6.0 (2023-10)
10. The gNB-DU triggers the establishment of F1-U resources, which are established either per gNB-DU or per cell
or per MBS Area Session ID.
11/12. The gNB-CU-UP side of the F1-U is established by means of the E1AP MC Bearer Context Modification
procedure, providing the gNB-DU side F1-U TNL to the gNB-CU-UP, which provides the gNB-CU-UP side F1-
U TNL address in return.
13. The gNB-CU-UP side F1-U TNL address is provided to the gNB-DU.
14. In case of NG-U multicast transport, the gNB-CU-UP joins the NG-U multicast group.
15. The gNB successfully terminates the NGAP procedure for establishing the multicast session context.
16. The gNB-CU-CP RRC-configures each UE which has joined the multicast group.
17. The multicast MBS media stream is provided to the UEs.
On NG-U, in case of location dependent multicast MBS Sessions, multiple shared NG-U transport tunnels may need to
be setup, one per Area Session ID served by the gNB.
In case of shared NG-U termination,
-
 the gNB-CU-UP may provide the gNB-CU-CP at E1 setup or configuration update about established shared NG-
U terminations, indicated by one or several MBS Session IDs.
-
 at establishment of the MC bearer context in the gNB-CU-UP, the gNB-CU- CP may request the gNB-CU-UP to
either apply the available MRB configuration of the shared NG-U termination, or to apply the MRB
configuration requested by the gNB-CU-CP. The gNB-CU-UP provides the MRB configuration to the gNB-CU-
CP if the MRB configuration requested by the gNB-CU-CP and the available MRB configuration of the shared
NG-U termination are different.",94.png
"Figure 8.15.1.3-1: Multicast MRB type re-configuration with F1-U ptp retransmission tunnel establishment
","1. The gNB-DU decides to change the MRB type configuration for a UE and provides the new configuration to the
gNB-CU-CP along with a per-MRB MRB type reconfiguration indication and the MRB Reconfigured RLC
mode.
2. The gNB-CU-CP confirms the modification request and indicates this to the gNB-DU. The gNB-CU-CP may
request the gNB-DU to establish F1-U ptp retransmission resources in order for the UE to perform PDCP Status
Report and receive retransmitted PDCP PDUs for the reconfigured MRBs.
4. - 7. If necessary, the gNB-DU requests the establishment of F1-U resources for ptp retransmission by means of
triggering the F1AP Multicast Distribution Setup procedure, which in turn triggers the E1AP MC Bearer Context
Modification procedure to exchange F1-U tunnel end-point addresses.",95.png
"Figure 8.15.2.1-1: Inter-gNB-CU Mobility for Multicast
","1. The Source gNB-CU-CP sends MC BEARER CONTEXT MODIFICATION REQUEST message towards the
Source gNB-CU-UP, to request the last delivered MRB Progress of an MBS Session related to a Multicast F1-U
Context Reference E1.
2. The Source gNB-CU-UP responds to the gNB-CU-CP in the MC BEARER CONTEXT MODIFICATION
RESPONSE message, providing the last delievered MRB Progress.
3. The source gNB-CU-CP sends the HANDOVER REQUEST message to the target gNB-CU-CP with the last
delievered MRB progress for the Multicast sessions the UE has joined.
4. In case the Multicast session which the UE has joined was not established in the target cell, the target gNB-CU-
CP triggers the Multicast MBS Session Context Establishment procedure as defined in section 8.15.1.2.
5. The target gNB-CU-CP triggers MC BEARER CONTET SETUP REQUEST message towards the target gNB-
CU-UP.
6. The target gNB-CU-UP responds to the target gNB-CU-CP by sending the MC BEARER CONTET SETUP
RESPONSE message.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 93
 ETSI TS 138 401 V17.6.0 (2023-10)
7. The target gNB-CU-CP sends UE CONTEXT SETUP REQUEST towards the target gNB-DU. If the target
gNB-CU-CP has decided to request a PTP Forwarding tunnel, the message contains the PTP Forwarding Tunnel
Required indication and the last delivered MRB Progress for the MRBs requested to be configured.
8. The target gNB-DU sends UE CONTEXT SETUP RESPONSE towards the target gNB-CU-CP.
9. If a PTP Forwarding Tunnel was requested in step 7, the target gNB-DU shall, if supported, trigger the F1-U
tunnel establishment via MULTICAST DISTRIBUTION SETUP REQUEST, including the F1-U DL UP TNL
information and the last delievered MRB Progress for the each of the MRB.
10. The target gNB-CU-CP sends the MC BEARER CONTEXT MODIFICATION REQUEST towards the target
gNB-CU-UP, including for each MRB a request for the oldest availiable MRB Progress information, the last
delivered MRB Progress, and the F1-U DL UP TNL information.
11. Based on the information received in step 10, the target gNB-CU-UP determines whether the Xn-U data
forwarding is needed or not, and in case it is needed, provide for each MRB the oldest available MRB Progress
and the assigned XN-U DL Forwarding UP TNL Info to the target gNB-CU-CP in the MC BEARER
CONTEXT MODIFICATION RESPONSE message.
12. In case step 9 was triggerred, the target gNB-CU-CP sends the MULTICAST DISTRIBUTION SETUP
RESPONSE to the target gNB-DU.
13. The target gNB-CU-CP sends HANDOVER REQUEST ACKNOWLEDGE to the source gNB-CU-CP,
including the XN-U DL Forwarding UP TNL Info and the oldest available MRB Progress for each MRB.
14. The source gNB-CU-CP forwards the XN-U DL Forwarding UP TNL Info and the oldest available MRB
Progress for each MRB to the source gNB-CU-UP via MC BEARER CONTEXT MODIFICATION REQUEST
message.
15. The source gNB-CU-UP sends the MC BEARER CONTEXT MODIFICATION RESPONSE message to the
source gNB-CU-CP.
16. The source gNB-CU-UP starts to forward MBS data towards the target gNB-CU-UP.
NOTE: step 16 may happen before or after or in parallel with step 15.
17. If a PTP Forwarding Tunnel was established, the target gNB-CU-UP sends the forwarding data to the target
gNB-DU.",96.png
Figure 8.16.1-1 Conditional Secondary Node Addition procedure,"MN initiated Conditional PSCell Addition
The procedure for MN initiated Conditional PSCell Addition (CPA) is shown in Figure 8.16-1.1-12. The steps 1-12 are as defined in TS 37.340 [12].
a1-a5. The steps a1-a5 are as defined in clause 8.9.2 and with conditional indications.
a6. After Random Access procedure successfully performed at the candidate gNB-DU which becomes the target SN
gNB-DU, the target gNB-DU sends a Downlink Data Delivery Status frame to inform the target gNB-CU-UP. The
target gNB-DU also sends an ACCESS SUCCESS message to inform the target gNB-CU-CP of which cell the UE
has successfully accessed.",97.png
Figure 8.17.2.1-1 IAB inter-CU topology redundancy procedure,"1.The NR-DC establishment procedure is performed for the IAB-MT of the dual-connecting IAB-node as
described in TS 37.340 [12], clause 10.2. This procedure can be conducted before or after establishment of the
F1 interface between the IAB-DU and an IAB-donor-CU.
2.The F1-terminating IAB-donor-CU sends an IAB TRANSPORT MIGRATION MANAGEMENT REQUEST
message to the non-F1-terminating IAB-donor-CU to provide the context of the traffic to be offloaded.
3.The non-F1-terminating IAB-donor-CU sends a DL RRC MESSAGE TRANSFER message to the second parent
IAB-DU, which includes an RRCReconfiguration message for the dual-connecting IAB-MT. The RRC
configuration includes a BAP address for the boundary node, pertaining to the non-F1-terminating IAB-donor-
CU’s topology. The RRC configuration may include new TNL address(es) for the dual-connecting IAB-node,
anchored at the second-path, i.e., at the IAB-donor-DU under the non-F1-terminating IAB-donor-CU. In case
IPsec tunnel mode is used to protect the F1 and non-F1 traffic, the new TNL address refers to the outer IP
address.
4. The second parent IAB-DU forwards the received RRCReconfiguration message to the dual-connecting IAB-
MT.
5. The dual-connecting IAB-MT responds to the second parent IAB-DU with an RRCReconfigurationComplete
message.
6. The second parent IAB-DU sends an UL RRC MESSAGE TRANSFER message to the non-F1-terminating
IAB-donor-CU, to convey the received RRCReconfigurationComplete message.
7.The non-F1-terminating IAB-donor-CU may configure or modify BH RLC channels and BAP-sublayer routing
entries on the second path between the dual-connecting IAB-node and the second-path IAB-donor-DU, as well
as DL mappings on the second-path IAB-donor-DU for the dual-connecting IAB-node’s second path. The DL
mappings may be based on the TNL address(es) allocated to the dual-connecting IAB-node in step 3. These
configurations may support the transport of UP and non-UP traffic on the second path.
8.The non-F1-terminating IAB-donor-CU responds with an IAB TRANSPORT MIGRATION MANAGEMENT
RESPONSE message to the F1-terminating IAB-donor-CU, to provide the mapping information for the traffic to
be offloaded as indicated in step 2. The message includes the L2 info necessary to configure the dual-connecting
IAB-node with the UL mappings for this traffic. The message includes the DSCP/IPv6 Flow Label values to be
used for the DL traffic to be offloaded.
9.The F1-terminating IAB-donor-CU updates the boundary node with the UL BH information received from the
non-F1-terminating IAB-donor-CU in Step 8 for the traffic to be offloaded. This step may also update UL
FTEID and DL FTEID associated with individual GTP-tunnel(s). The affected GTP tunnel(s) will be switched to
use the dual-connecting IAB-node’s new TNL address(es). This step may use non-UE associated signaling in E1
and/or F1 interface to provide updated UP configuration for F1-U tunnels of multiple connected UEs or child
IAB-MTs. Implementation must ensure the avoidance of potential race conditions, i.e., that no conflicting
configurations are concurrently performed using UE-associated and non-UE-associated procedures.
The F1-terminating IAB-donor-CU may also provide UL BH information associated with non-UP traffic. New
TNL addresses for F1-C traffic configured in step 3, if any, can be added to the dual-connecting IAB-DU’s F1-C
association(s) with the F1-terminating IAB-donor-CU.
If new TNL addresses for F1-C traffic are configured, new SCTP association(s) between the dual-connecting
IAB-node and the F1-terminating IAB-donor-CU may be established using the new TNL address information of
the dual-connecting IAB-node. The dual-connecting IAB-node sends an F1AP gNB-DU CONFIGURATION
UPDATE message to the F1-terminating IAB-donor-CU, which may include new (outer) IP addresses and
corresponding new (inner) IP address for offloaded F1-U traffic.
NOTE:
The IP address selected by the boundary IAB-node for a traffic needs to be anchored at the IAB-donor-
DU whose BAP address is contained in the BAP routing ID of the UL mapping for this traffic, and
configured by the IAB-donor (MN/SN) of the egress topology of the traffic.
10. The F1-terminating IAB-donor-CU sends an IAB TRANSPORT MIGRATION MANAGEMENT REQUEST
message to the non-F1-terminating IAB-donor-CU, to modify the context of the dual-connecting IAB-node’s
offloaded traffic. The message may include the DL TNL address information used for the offloaded traffic and
reported by the boundary node in step 9. The non-F1-terminating IAB-donor-CU may use this information to
configure DL mappings on the second-path IAB-donor-DU.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 97
 ETSI TS 138 401 V17.6.0 (2023-10)
11. The non-F1-terminating IAB-donor-CU responds with an IAB TRANSPORT MIGRATION MANAGEMENT
RESPONSE message to the F1-terminating IAB-donor-CU.
12. The steps above, may be repeated, except step 1, if needed, for the F1-terminating IAB-donor-CU to request
addition, modification, or release of the offloaded traffic. The non-F1-terminating IAB-donor-CU can fully or
partially reject the addition or modification requested by the F1-terminating IAB-donor-CU.
The non-F1-terminating IAB-donor-CU may request the modification of the L2 transport for the offloaded
traffic in the non-F1-terminating IAB-donor-CU’s topology using the IAB TRANSPORT MIGRATION
MODIFICATION REQUEST message. The F1-terminating IAB-donor-CU reconfigures UL BH mappings
accordingly and acknowledges the modification via the IAB TRANSPORT MIGRATION MODIFICATION
RESPONSE message. The non-F1-terminating IAB-donor-CU may further reconfigure the TNL addresses of the
dual-connecting IAB-node via RRC.
The traffic offload for descendant nodes follows the same procedure as defined for the partial migration in clause
8.17.3.2.",98.png
Figure 8.17.3.1-1: IAB inter-CU topology adaptation procedure,"The source IAB-donor-CU sends an Xn HANDOVER REQUEST message to the target IAB-donor-CU . This
message may include the migrating IAB-node’s TNL address information in the RRC container.
2.The target IAB-donor-CU sends a UE CONTEXT SETUP REQUEST message to the target parent node IAB-
DU, to create the UE context for the migrating IAB-MT and to set up the bearers, which the migrating IAB-MT
uses for its signaling, and, optionally, data traffic.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 99
 ETSI TS 138 401 V17.6.0 (2023-10)
3. The target parent node IAB-DU responds to the target IAB-donor-CU with a UE CONTEXT SETUP
RESPONSE message.
4.The target IAB-donor-CU performs admission control and provides the new RRC configuration as part of the
HANDOVER REQUEST ACKNOWLEDGE message. The RRC configuration includes a BAP address for the
boundary node in the target IAB-donor-CU’s topology, a default BH RLC channel and a default BAP routing ID
configuration for UL F1-C/non-F1 traffic mapping on the target path. The RRC configuration may include the
new TNL address(es) anchored at the target IAB-donor-DU for the migrating node.
5.The source IAB-donor-CU sends a UE CONTEXT MODIFICATION REQUEST message to the source parent
node IAB-DU, which includes the received RRCReconfiguration message from the target IAB-donor-CU.
6. The source parent node IAB-DU forwards the received RRCReconfiguration message to the migrating IAB-MT.
7.The source parent node IAB-DU responds to the source IAB-donor-CU with the UE CONTEXT
MODIFICATION RESPONSE message.
8. The migrating IAB-MT performs a random access procedure at the target parent node IAB-DU.
9.The migrating IAB-MT responds to the target parent node IAB-DU with an RRCReconfigurationComplete
message.
10. The target parent node IAB-DU sends an UL RRC MESSAGE TRANSFER message to the target IAB-donor-
CU, to convey the received RRCReconfigurationComplete message.
11. The target IAB-donor-CU triggers the path switch procedure for the migrating IAB-MT, if needed.
12. The target IAB-donor-CU sends UE CONTEXT RELEASE message to the source IAB-donor-CU.
NOTE:
The XnAP UE IDs of the migrating node are retained at target and source IAB-donor-CU as long as the
target path is used for transport of traffic between the migrating node and the source IAB-donor-CU.
13. The source IAB-donor-CU may release BH RLC channels and BAP-sublayer routing entries on the source path
between source parent IAB-node of the migrating IAB-node and the source IAB-donor-DU.
14. The target IAB-donor-CU configures BH RLC channels and BAP-sublayer routing entries on the target path
between the migrating IAB-node and target IAB-donor-DU, as well as DL mappings on the target IAB-donor-
DU for the migrating IAB-node’s target path. These configurations support the transport of F1-C traffic on the
target path.
15. The F1-C connection between the migrating IAB-node and the source IAB-donor-CU are switched to the target
path using the new TNL address information of the migrating IAB-node. The migrating IAB-node may report
the new TNL address information it wants to use for F1-U traffic to the source IAB-donor-CU, via the gNB-DU
CONFIGURATION UPDATE message.
In case IPsec tunnel mode is used for TNL protection, the migrating IAB-node may use MOBIKE (IETF RFC
4555 [29]) to migrate the IPsec tunnel to the new IP outer addresses. After the completion of the MOBIKE
procedure, the migrating IAB-DU initiates an F1AP gNB-DU Configuration Update procedure from which the
IAB-donor-CU can conclude whether the existing inner IP address(es) (e.g., for SCTP association) and the DL
F-TEID can be reused.
If new TNL addresses for F1-C traffic are configured, new SCTP association(s) between the migrating IAB-node
and the F1-terminating IAB-donor-CU may be established using the new TNL address information of the
migrating IAB-node. The migrating IAB-node sends an F1AP gNB-DU CONFIGURATION UPDATE message
to the F1-terminating IAB-donor-CU, which may include new (outer) IP addresses and corresponding new
(inner) IP address for the F1-U traffic to be switched to the target path.
16. The source IAB-donor-CU sends an IAB TRANSPORT MIGRATION MANAGEMENT REQUEST message
to the target IAB-donor-CU, to provide the context of the traffic to be offloaded. The message may include the
new DL TNL address information necessary for the target IAB-donor-CU to configure or modify DL mappings
on the target IAB-donor-DU.
17. The target IAB-donor-CU may configure or modify BH RLC channels and BAP-sublayer routing entries on the
target path between the migrating IAB-node and target IAB-donor-DU, as well as DL mappings on the target
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 100
 ETSI TS 138 401 V17.6.0 (2023-10)
IAB-donor-DU for the migrating IAB-node’s target path. These configurations may support the transport of UP
and non-UP traffic on the target path.
18. The target IAB-donor-CU responds to the source IAB-donor-CU with an IAB Transport Migration Management
Response message, to provide the mapping information for the traffic to be offloaded. The message includes the
L2 info that is used in the target IAB-donor-CU’s topology and necessary to configure the migrating IAB-node
with the UL mappings of traffic indicated in step 16. The message includes the DSCP/IPv6 Flow Label values
used to configure the DL mappings of traffic indicated in step 16.
19. The F1-U connections of the migrating IAB-node with the source IAB-donor-CU are switched to use the
migrating IAB-node’s new TNL address(es). The source IAB-donor-CU provides to the IAB-DU of the
migrating IAB-node the updated UL BH information for the traffic indicated in step 16, based on the UL BH
information received from the target IAB-donor-CU in step 18. The source IAB-donor-CU may also update the
UL BH information associated with non-UP traffic. This step may use UE associated signaling or non-UE
associated signaling in E1 and/or F1 interface. Implementation must ensure the avoidance of potential race
conditions, i.e., that no conflicting configurations are concurrently performed using UE-associated and non-UE-
associated procedures.
20. The steps 16 to 19 may be repeated, if needed, where the source IAB-donor-CU can request the offload of
further traffic, or the modification or release of offloaded traffic. The target IAB-donor-CU can fully or partially
reject addition or modification requests by the source IAB-donor-CU.",99.png
"Figure 8.17.3.2-1: IAB inter-CU topology adaptation procedure with descendant IAB-node
"," The topology adaptation procedure of clause 8.17.3.1 is performed for the migrating IAB-node.
1.The source IAB-donor-CU sends an IAB TRANSPORT MIGRATION MANAGEMENT REQUEST message
to the target IAB-donor-CU to provide the context of the descendant IAB-node’s traffic to be offloaded. The
message may include a request for new TNL address(es) for the descendant IAB-node(s), anchored at a target
IAB-donor-DU. The source IAB-donor-CU includes an identifier of the migrating IAB-node in the request
message. This could be performed in parallel with step 0 after the source IAB-donor-CU receives HANDOVER
REQUEST ACKNOWLEDGE message, e.g., the context of the traffic to be offloaded for the
migrating/descendant nodes and IP address request information could be contained in the same IAB
TRANSPORT MIGRATION MANAGEMENT REQUEST message.
2. The target IAB-donor-CU determines the target IAB-donor-DU, based on the identifier of the migrating IAB-
node. The target IAB-donor-CU may configure or modify BH RLC channels and BAP-sublayer routing entries
on the target path between the boundary IAB-node and target IAB-donor-DU, as well as DL mappings on the
target IAB-donor-DU for the migrating IAB-node’s target path. These configurations may support the transport
of UP and non-UP traffic on the target path.
3. The target IAB-donor-CU may obtain new TNL address(es) from the target IAB-donor-DU, based on the request
for TNL address(es) received in step 1.
4.The target IAB-donor-CU responds with an IAB TRANSPORT MIGRATION MANAGEMENT RESPONSE
message to the source IAB-donor-CU, to provide the mapping information for the traffic to be offloaded. The
message includes the L2 info from the target IAB-donor-CU topology that is necessary to configure the
migrating IAB-node with the BAP-sublayer routing, header-rewriting and BH RLC CH mapping entries of
traffic indicated in step 1. The message includes the DSCP/IPv6 Flow Label values to be used for the DL traffic
to be offloaded as indicated in step 1. The message may include the new TNL address(es) obtained in step 3, if
any.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 102
 ETSI TS 138 401 V17.6.0 (2023-10)
NOTE 1: The target IAB-donor-CU should select the same IAB-donor-DU in its IAB topology for all to-be-
offloaded traffic, whose UL BH mappings received from the source IAB-donor-CU in step 1 share the
same BAP address.
NOTE 2: The target IAB-donor-CU should provide the same Egress BAP Routing ID for all to-be-offloaded uplink
traffic, whose UL BH mappings received from the source IAB-donor-CU in step 1 share the same Ingress
BAP Routing ID.
5. The source IAB-donor-CU configures the migrating IAB-node’s IAB-DU with the BAP-sublayer routing, header-
rewriting and BH RLC CH mapping entries of the migrating IAB-node.
6. The source IAB-donor-CU sends a DL RRC MESSAGE TRANSFER message to the descendant IAB-node’s
parent IAB-DU, which includes an RRCReconfiguration message for the descendant IAB-MT. The RRC
configuration may include the new TNL addresses received in step 4. If needed, the source IAB-donor-CU may
also provide a new default UL mapping which includes a default BH RLC channel and a default BAP Routing
ID on the target path, to the descendant nodes via RRCReconfiguration message.
7. The descendant IAB-node’s parent IAB-DU forwards the received RRCReconfiguration message to the
descendant IAB-MT.
8. The descendant IAB-MT responds to the migrating IAB-node’s IAB-DU with an RRCReconfigurationComplete
message.
9. The migrating IAB-node’s IAB-DU sends an UL RRC MESSAGE TRANSFER message to the source IAB-
donor-CU, to convey the received RRCReconfigurationComplete message.
10. If needed, the source IAB-donor-CU configures UL BH mappings on the descendant node and BAP-sublayer
routing entries between the descendant node and the migrating IAB-node. This step may be performed at an
earlier stage, e.g., immediately after step 4.
11. The F1-C connections and F1-U tunnels are switched to use the descendant IAB-node’s new TNL address(es), if
any, as described in Steps 15 and 19 of the inter-CU topology adaptation procedure in clause 8.17.3.1.
NOTE:
The IP address selected by the descendant IAB-node for an offloaded traffic needs to be anchored at the
IAB-donor-DU whose BAP address is contained in the BAP routing ID of the UL mapping for this
traffic, and obtained in step 7.
12. The source IAB-donor-CU sends an IAB TRANSPORT MIGRATION MANAGEMENT REQUEST message
to the target IAB-donor-CU, to modify the context of the descendant IAB-node’s offloaded traffic. The message
may include the DL TNL address information received in step 11 that is necessary for the target IAB-donor-CU
to configure or modify DL mappings on the target IAB-donor-DU.
13. The target IAB-donor-CU responds with an IAB TRANSPORT MIGRATION MANAGEMENT RESPONSE
message to the source IAB-donor-CU.
14. The of steps above may be repeated, if needed, for the source IAB-donor-CU to request addition, modification
or release of the offloaded traffic pertaining to the descendant IAB-node. The target IAB-donor-CU can fully or
partially reject addition or modification requests by the source IAB-donor-CU.
The target IAB-donor-CU may trigger the modification of the L2 transport of the offloaded traffic in the target IAB-
donor-CU’s topology using the IAB TRANSPORT MIGRATION MODIFICATION REQUEST message. Based on
this message, the source IAB-donor-CU may reconfigure the UL BH mappings on the descendant nodes, the routing
entries and BH RLC channel mappings on the migrating node and the descendant nodes, and the BAP header rewriting
entries on the migrating node, and acknowledges the modification via the IAB TRANSPORT MIGRATION
MODIFICATION RESPONSE message. The target IAB-donor-CU may further provide updated TNL address
information for the descendant IAB-node to the source IAB-donor-CU.",100.png
Figure 8.17.4-1: IAB inter-CU backhaul RLF recovery procedure for an IAB-node in SA mode,"1. The IAB-MT of the IAB-node detects backhaul RLF.
2. The IAB-MT attempts RLF recovery by performing Random Access towards a new parent IAB-DU.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 104
 ETSI TS 138 401 V17.6.0 (2023-10)
3. The IAB-MT undergoing RLF recovery sends an RRCReestablishmentRequest message to the new parent IAB-
DU.
4. The new parent IAB-DU sends an INITIAL UL RRC MESSAGE to the new IAB-donor-CU, to convey the
received RRCReestablishmentRequest message.
5. The new IAB-donor-CU retrieves the UE Context for the IAB-MT undergoing recovery, through the XnAP
Retrieve UE Context procedure. The initial IAB-donor-CU may include the TNL address information of the
IAB-node undergoing recovery in the RRC container of the RETRIEVE UE CONTEXT RESPONSE message.
6. The new IAB-donor-CU sends a DL RRC MESSAGE TRANSFER message to the new parent IAB-DU, to
convey the generated RRCReestablishment message.
7. The new parent IAB-DU sends an RRCReestablishment message to the IAB-MT undergoing recovery.
8. The IAB-MT undergoing recovery sends an RRCReestablishmentComplete message to the new parent IAB-DU.
9. The new parent IAB-DU sends an UL RRC MESSAGE TRANSFER message to the new IAB-donor-CU, to
convey the received RRCReestablishmentComplete message.
10. The new IAB-donor-CU triggers the UE Context Setup procedure toward the new parent IAB-DU, to create the
UE context for the IAB-MT undergoing recovery and to set up one or more bearers. These bearers can be used
by the IAB-MT undergoing recovery for its own signalling, and, optionally, data traffic.
11. The new IAB-donor-CU triggers the path switch procedure for the IAB-MT undergoing recovery, if needed.
12. The new IAB-donor-CU sends UE CONTEXT RELEASE message to the initial IAB-donor-CU.",101.png
"Figure 8.18.1-1: RACH based Small Data Transmission in RRC Inactive state.
","1. The UE in RRC Inactive sends the RRCResumeRequest message together with UL SDT data and/or UL SDT
signalling.
2. The gNB-DU buffers the UL SDT data and/or UL SDT signalling.
3. The step 3 is as defined in step 4 in clause 8.6.2, including an indication of SDT access. The gNB-DU may also
provide SDT assistance information.
4-5. If UE context is successfully retrieved as specified in TS 38.300 [2], the steps 4-5 are as defined in steps 6-7
in clause 8.9.6.2. The UL SDT data, if any, is forwarded to the gNB-CU-UP, and the UL signalling, if any, is
forwarded to the gNB-CU-CP via the UL RRC MESSAGE TRANSFER message, in which any UL NAS PDU
is delivered to AMF.
NOTE 1: In case that full UE context is retrieved from another gNB-CU-CP as specified in TS 38.300 [2], the
gNB-CU-CP first establishes the UE context in the gNB-CU-UP via the Bearer Context Setup procedure
and F1-U UL TEIDs are retrieved before step 4. The BEARER CONTEXT SETUP REQUSET message
may include an indication to suspend non-SDT bearers, and in this case, the BEARER CONTEXT
MODIFICATION REQUEST message in step 6 does not include resume indication for SDT DRBs.
NOTE 2: In case that only partial UE context for SDT including F1-U UL TEIDs is retrieved from another gNB-
CU-CP as specified in TS 38.300 [2], the gNB-CU-CP uses those F1-U UL TEIDs for steps 4-5, and the
subsequent steps 6-7 are not executed. The F1-U DL TEIDs received from the gNB-DU in step 5 should
be forwarded to the other gNB-CU-CP, to be used for transferring of the DL SDT data. In addition, the
UL SDT data, if any, is forwarded from the gNB-DU to the gNB-CU-UP of the other gNB-CU-CP for
which the partial context is retrieved, and the UL signalling, if any, is forwarded from the gNB-CU-CP to
the other gNB-CU-CP (the last serving gNB-CU-CP) via the XnAP RRC TRANSFER message.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 106
 ETSI TS 138 401 V17.6.0 (2023-10)
NOTE 3: The other gNB-CU-UP may need to buffer the UL SDT data if received before the SDT bearer(s) are
resumed.
6.The gNB-CU-CP sends the BEARER CONTEXT MODIFICATION REQUEST message including an resume
indication for SDT DRBs. The gNB-CU-CP also includes the F1-U DL TEIDs received from the gNB-DU in
step 5.
7. The gNB-CU-UP responds with the BEARER CONTEXT MODIFICATION RESPONSE message.
NOTE 4: Upon receiving the UE INACTIVITY NOTIFICATION message from the gNB-DU and deciding to
terminate the SDT, the gNB-CU, if serving the UE, shall transmit the UE CONTEXT RELEASE
COMMAND message to the gNB-DU. If CG-SDT is (re-)configured, the gNB-CU may request the gNB-
DU to keep CG-SDT configuration and resources in the UE CONTEXT RELEASE COMMAND
message.
Upon receiving non-SDT data, the gNB-CU-UP shall send the DL DATA NOTIFICATION message to the gNB-CU-
CP. The gNB-CU-CP shall terminate the ongoing SDT procedure as specified in TS 38.300 [2].",102.png
"Figure 8.18.2-1: CG based Small Data Transmission in RRC Inactive state.
","1. The gNB-CU decides to move UE into RRC_INACTIVE state.
2. The gNB-CU-CP decides to configure CG-SDT, it sends UE CONTEXT MODIFICATION REQUEST message
including a query indication for CG-SDT related resource configuration associated with the information of SDT
Radio Bearer(s).
3. The gNB-DU sends the UE CONTEXT MODIFICATION RESPONSE message including the CG-SDT related
resource configurations for the requested SDT Radio Bearer(s) within the DU to CU RRC Information IE.
4. The gNB-CU-CP sends the BEARER CONTEXT MODIFICATION REQUEST towards the gNB-CU-UP, with
the suspend indication.
5. The gNB-CU-UP sends the BEARER CONTEXT MODIFICATION RESPONSE towards the gNB-CU-CP.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 107
 ETSI TS 138 401 V17.6.0 (2023-10)
6. The gNB-CU-CP sends the UE CONTEXT RELEASE COMMAND message to the gNB-DU including an
RRCRelease message to the UE with the CG-SDT information within suspend configuration. The gNB-CU
notifies the gNB-DU to keep the SDT RLC config, F1-U tunnels, F1AP UE association, and store the CG
resource for SDT when the UE is entering RRC_INACTIVE state with an explicit CG-SDT kept indicator.
7. The gNB-DU sends the RRCRelease message to UE.
8. The gNB-DU sends UE CONTEXT RELEASE COMPLETE message. The gNB-DU keeps the SDT RLC
config, F1-U tunnels, F1AP UE association, and stores the CG resource for SDT when the UE entering
RRC_INACTIVE. The gNB-DU also stores the C-RNTI, CS-RNTI, and which bearers are CG-SDT bearers.
After a period of time of the UE being in RRC_INACTIVE state.
9. The UE decides to perform CG based SDT procedure, it sends the RRCResumeRequest message together with
UL SDT data/UL NAS PDU.
10. The gNB-DU sends the UL RRC MESSAGE TRANSFER message including the RRCResumeRequest message
to indicate the access due to CG-SDT.
11/12. If UE context is successfully retrieved as specified in TS 38.300 [2], the gNB-CU-CP initiates the BEARER
CONTEXT MODIFICATION procedure to resume SDT DRBs.
13 – 13a. The gNB-DU sends the UL SDT data, if any, to the gNB-CU-UP, and/or sends the UL signalling, if any,
to the gNB-CU-CP via the UL RRC MESSAGE TRANSFER message, in which any UL NAS PDU is delivered
to AMF.",103.png
Figure 8.18.3-1: RA-SDT or non-SDT with CG-SDT configuration.,"1. The UE in RRC Inactive sends RRCResumeRequest message. If the UE decides to perform RACH based SDT
procedure, it also sends UL SDT data and/or UL SDT signalling.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 108
 ETSI TS 138 401 V17.6.0 (2023-10)
2. The gNB-DU buffers the UL SDT data and/or UL SDT signalling.
3. The gNB-DU sends the INITIAL UL RRC MESSAGE TRANSFER message to the gNB-CU-CP, including a new
gNB-DU UE F1AP ID, and in case of RACH based SDT access, the gNB-DU provides an indication of SDT access and
may also the SDT assistance information.
4. If UE context is successfully retrieved as specified in TS 38.300 [2], the gNB-CU-CP sends the UE CONTEXT
SETUP REQUEST message with the stored (or retrieved from the last serving gNB) F1 UL TEIDs and the new gNB-
DU UE F1AP ID received in step 3.
In case that the gNB-DU is the one that sent the RRCRelease message with CG-SDT resource configurations to the UE,
the gNB-CU-CP also includes the old gNB-DU UE F1AP ID and the old gNB-CU F1AP UE ID within the Old CG-
SDT Session Info IE of the UE CONTEXT SETUP REQUEST message.
In case that the gNB-CU-CP is the one that generated the RRCRelease message with CG-SDT resource
configurations but the gNB-DU is not the old gNB-DU that sent the RRCRelease message to the UE, the gNB-CU-
CP initiates the UE Context Release procedure by sending the UE CONTEXT RELEASE COMMAND message to
the old gNB-DU.
In case that the UE accesses a gNB other than the last serving gNB, upon receiving the RETRIEVE UE CONTEXT
REQUEST message from the receiving gNB-CU-CP, the last serving gNB-CU-CP initiates the UE Context Release
procedure by sending the UE CONTEXT RELEASE COMMAND message to the last serving gNB-DU.
5. The gNB-DU sends the UE CONTEXT SETUP RESPONSE message with the new gNB-DU UE F1AP ID. In case
the old gNB-DU UE F1AP ID is received within the Old CG-SDT Session Info IE in step 4, the gNB-DU retrieves the
stored CG-SDT resource configurations and UE context based on the Old CG-SDT Session Info IE, if any, and
associates them with the new gNB-DU F1AP UE ID.",104.png
"Figure 8.19.1-1: Remote UE Initial Access procedure
","1.The U2N Remote UE and the U2N Relay UE perform discovery procedure, and establish PC5 connection using
NR ProSe procedure.
2. The U2N Remote UE sends an RRCSetupRequest message to the U2N Relay UE via PC5 Relay RLC Channel.
3. The U2N Relay UE withholds the received RRC message and sends the SidelinkUEInformationNR message to
the gNB-DU. Before that, if the U2N Relay UE is in RRC_IDLE/RRC_INACTIVE state, it should trigger the
RRC establishment/resume procedure to enter RRC_CONNECTED state and gNB may configure the U2N
Relay UE with Uu Relay RLC channel(s) for relaying of U2N Remote UE’s SRB0/1.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 110
 ETSI TS 138 401 V17.6.0 (2023-10)
4.The gNB-DU sends the UL RRC MESSAGE TRANSFER message of the U2N Relay UE by encapsulating the
SidelinkUEInformationNR message to gNB-CU, and gNB-CU allocates the local ID of U2N Remote UE.
5. The gNB-CU sends the UE CONTEXT MODIFICATION REQUEST message of the U2N Relay UE to gNB-
DU. Such message may request the establishment of Uu Relay RLC channel(s) for the transmission of U2N
Remote UE’s SRB0/1 if not configured yet.
6. The gNB-DU sends the UE CONTEXT MODIFICATION RESPONSE message of the U2N Relay UE to gNB-
CU.
7.The gNB-CU sends the DL RRC MESSAGE TRANSFER message of the U2N Relay UE to gNB-DU by
encapsulating the RRCReconfiguration message, which contains the local ID allocated to the U2N Remote UE.
The RRCReconfiguration message shall also contain the Uu Relay RLC channel(s) configuration if not
configured and bearer mapping for relaying of U2N Remote UE’s SRB0/1.
8. The gNB-DU sends the RRCReconfiguration message to the U2N Relay UE to configure the local ID of the
U2N Remote UE, the Uu Relay RLC channel(s) configuration and bearer mapping for relaying of U2N Remote
UE’s SRB0/1.
9. The U2N Relay UE sends the RRCReconfigurationComplete message to gNB-DU.
10. The gNB-DU sends the UL RRC MESSAGE TRANSFER message of the U2N Relay UE by encapsulating the
RRCReconfigurationComplete message to gNB-CU.
11. After receiving the local ID of the U2N Remote UE and the Uu Relay RLC channel(s) configuration and bearer
mapping for relaying of U2N Remote UE’s SRB0, the U2N Relay UE sends the RRCSetupRequest message of
the U2N Remote UE to gNB-DU. The local ID of the U2N Remote UE and RB ID for SRB0 are conveyed in the
SRAP header.
12. The gNB-DU allocates a C-RNTI and a gNB-DU UE F1AP ID for the U2N Remote UE and sends the INITIAL
UL RRC MESSAGE TRANSFER message to gNB-CU by encapsulating the RRCSetupRequest message of the
U2N Remote UE. In addition, the local ID of the U2N Remote UE , the gNB-DU UE F1AP ID of the U2N Relay
UE and the sidelink configuration container for at least the PC5 Relay RLC channel configuration for relaying of
U2N Remote UE’s SRB1 are included in the INITIAL UL RRC MESSAGE TRANSFER message.
13. The gNB-CU allocates a gNB-CU UE F1AP ID for the U2N Remote UE and generates a RRCSetup message
towards the U2N Remote UE. The RRC message is encapsulated in the DL RRC MESSAGE TRANSFER
message, and includes the configurations of PC5 Relay RLC channel and bearer mapping at least for the
transmission of U2N Remote UE’s SRB1.
14. The gNB-DU sends the RRCSetup message to the U2N Remote UE via the U2N Relay UE.
15. The gNB-CU configures the U2N Relay UE with PC5 Relay RLC channel, Uu Relay RLC channel and bearer
mapping for relaying of U2N Remote UE’s SRB1. According to the configuration from gNB-CU, the U2N
Relay UE establishes a PC5 Relay RLC channel for relaying of U2N Remote UE’s SRB1 over PC5 and
establishes a Uu Relay RLC channel for relaying of U2N Remote UE’s SRB1 towards gNB-DU if not
configured yet.
NOTE 1: This step may be performed earlier, e.g., via steps 5~8.
16. The U2N Remote UE sends the RRCSetupComplete message to the gNB-DU via the U2N Relay UE.
17. The gNB-DU encapsulates the RRC message in the UL RRC MESSAGE TRANSFER message and sends it to
the gNB-CU.
18. Upon receiving the RRCSetupComplete message of U2N Remote UE, the gNB-CU sends the INITIAL UE
MESSAGE message to the AMF.
19. The AMF sends the INITIAL CONTEXT SETUP REQUEST message to the gNB-CU.
20. The gNB-CU sends the UE CONTEXT SETUP REQUEST message to establish the U2N Remote UE context in
the gNB-DU. Such message may request the configuration of PC5 Relay RLC channels for the transmission of
U2N Remote UE’s SRB2 and DRBs, and may also encapsulate the SecurityModeCommand message.
21. The gNB-DU sends the SecurityModeCommand message to the U2N Remote UE via U2N Relay UE.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 111
 ETSI TS 138 401 V17.6.0 (2023-10)
22. The gNB-DU sends the UE CONTEXT SETUP RESPONSE message of the U2N Remote UE to the gNB-CU,
which contains the configuration of PC5 Relay RLC channels for the transmission of U2N Remote UE’s SRB2
and DRBs.
23. The U2N Remote UE responds with the SecurityModeComplete message.
24. The gNB-DU encapsulates the RRC message in the UL RRC MESSAGE TRANSFER message and sends it to
the gNB-CU.
25. The gNB-CU generates the RRCReconfiguration message for U2N Remote UE and encapsulates it in the DL
RRC MESSAGE TRANSFER message. The RRCReconfiguration message contains the configuration of PC5
Relay RLC channels and bearer mapping for the transmission of U2N Remote UE’s SRB2 and DRBs.
26. The gNB-DU sends RRCReconfiguration message to the U2N Remote UE via the U2N Relay UE.
27. The U2N Remote UE sends RRCReconfigurationComplete message to the gNB-DU via the U2N Relay UE.
28. The gNB-DU encapsulates the RRC message in the UL RRC MESSAGE TRANSFER message and send it to
the gNB-CU.
29. The gNB-CU sends the INITIAL CONTEXT SETUP RESPONSE message to the AMF.
30. The gNB-CU configures additional Uu Relay RLC channels between the gNB-DU and the U2N Relay UE, and
additional PC5 Relay RLC channels for the U2N Relay UE for relaying of U2N Remote UE’s DRBs and SRBs.
Also, such step may configure the bearer mapping between U2N Remote UE’s DRB/SRB and PC5/Uu Relay
RLC channel at the U2N Relay UE.
NOTE 2: This step may be performed earlier.",105.png
"Figure 8.19.2-1: Remote UE RRC Reestablishment procedure
","1. The U2N Remote UE and the U2N Relay UE perform discovery procedure, and establish PC5 connection using
NR ProSe procedure. This step may be omitted if PC5 connection was established.
2. The U2N Remote UE sends an RRCReestablishmentRequest message to the U2N Relay UE via PC5 Relay RLC
Channel.
3~10. The gNB-CU allocates the local ID of the U2N Remote UE if the U2N Relay UE does not have it. The
details of those steps can be referred to clause 8.19.1.
11. After receiving the local ID of the U2N Remote UE, the U2N Relay UE sends the RRCReestablishmentRequest
message of the U2N Remote UE to gNB-DU.
12. The gNB-DU allocates a C-RNTI and a gNB-DU UE F1AP ID for the U2N Remote UE and sends the INITIAL
UL RRC MESSAGE TRANSFER message to gNB-CU by encapsulating the RRCReestablishmentRequest
message of the U2N Remote UE. In addition, the local ID of the U2N Remote UE, the gNB-DU UE F1AP ID of
the U2N Relay UE and the sidelink configuration container for at least the PC5 Relay RLC channel
configuration for relaying of U2N Remote UE’s SRB1 are included in the INITIAL UL RRC MESSAGE
TRANSFER message.
13. The gNB-CU configures the U2N Relay UE with PC5 Relay RLC channel, Uu Relay RLC channel and bearer
mapping for relaying of U2N Remote UE’s SRB1. According to the configuration from gNB-CU, the U2N
Relay UE establishes a PC5 Relay RLC channel for relaying of U2N Remote UE’s SRB1 over PC5 and
establishes a Uu Relay RLC channel for relaying of U2N Remote UE’s SRB1 over Uu.
NOTE 1: This step may be performed earlier, e.g., via steps 5~8.
14~23. The details of those steps can be referred to Steps 5~14 in clause 8.7. For L2 U2N relay, the RRC message(s)
between the U2N Remote UE and the gNB-DU are relayed via the U2N Relay UE; Steps 18~19 may
additionally perform the configurations of PC5 Relay RLC channel(s) for relaying of U2N Remote UE’s SRB1,
SRB2 and DRBs.
24. The gNB-CU configures additional Uu Relay RLC channels between the gNB-DU and the U2N Relay UE, and
additional PC5 Relay RLC channels for the U2N Relay UE for relaying of U2N Remote UE’s DRBs and SRBs.
Also, such step may configure the bearer mapping between U2N Remote UE’s DRB/SRB and PC5/Uu Relay
RLC channel at the U2N Relay UE.
NOTE 2: This step may be performed earlier.",106.png
"Figure 8.19.3-1: Remote UE RRC Resume procedure
","1. The U2N Remote UE and the U2N Relay UE perform discovery procedure, and establish PC5 connection using
NR ProSe procedure. This step may be omitted if PC5 connection was established.
2. The U2N Remote UE sends an RRCResumeRequest message to the U2N Relay UE via PC5 RLC Relay Channel.
3~10. The gNB-CU allocates the local ID of the U2N Remote UE if the U2N Relay UE does not have it. The
details of those steps can be referred to clause 8.19.1.
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 115
 ETSI TS 138 401 V17.6.0 (2023-10)
11. After receiving the local ID of the U2N Remote UE, the U2N Relay UE sends the RRCResumeRequest message
of the U2N Remote UE to gNB-DU.
12. The gNB-DU allocates a C-RNTI and a gNB-DU UE F1AP ID for the U2N Remote UE and sends the INITIAL
UL RRC MESSAGE TRANSFER message to gNB-CU by encapsulating the RRCResumeRequest message of
the U2N Remote UE. In addition, the local ID of the U2N Remote UE, the gNB-DU UE F1AP ID of the U2N
Relay UE and the sidelink configuration container for at least the PC5 Relay RLC channel configuration for
relaying of U2N Remote UE’s SRB1 are included in the INITIAL UL RRC MESSAGE TRANSFER message.
13. The gNB-CU configures the U2N Relay UE with PC5 Relay RLC channel, Uu Relay RLC channel and bearer
mapping for relaying of U2N Remote UE’s SRB1. According to the configuration from gNB-CU, the U2N
Relay UE establishes a PC5 Relay RLC channel for relaying of U2N Remote UE’s SRB1 over PC5 and
establishes a Uu Relay RLC channel for relaying of U2N Remote UE’s SRB1 over Uu.
NOTE 1: This step may be performed earlier, e.g., via steps 5~8.
14~19. The details of those steps can be referred to Steps 5~10 in clause 8.6.2. For L2 U2N relay, the RRC
message(s) between the U2N Remote UE and the gNB-DU are relayed via the U2N Relay UE; Steps 14~15 may
additionally perform the configurations of PC5 Relay RLC channel(s) for relaying of U2N Remote UE’s SRB2
and DRBs.
20. The gNB-CU establishes additional Uu Relay RLC channels between the gNB-DU and the U2N Relay UE, and
additional PC5 Relay RLC channels for the U2N Relay UE for relaying of U2N Remote UE’s DRBs and SRBs.
Also, such step may configure the bearer mapping between U2N Remote UE’s DRB/SRB and PC5/Uu Relay
RLC channel at the U2N Relay UE.
NOTE 2: This step may be performed earlier.",107.png
Figure 8.19.4.1-1: U2N Remote UE Direct-to-indirect Path Switch with gNB-DU change procedure,"1.The Uu measurement configuration and measurement report signalling is performed between U2N Remote UE
and gNB-CU to evaluate both relay link measurement and Uu link measurement. The U2N Remote UE may
report one or multiple candidate U2N Relay UE(s) and Uu measurement results after it measures/discovers the
candidate U2N Relay UE(s).
2. The gNB-CU decides to switch the U2N Remote UE to a target U2N Relay UE under a different gNB-DU (i.e.,
target gNB-DU).
3. The reconfiguration to target U2N Relay UE is performed among U2N Relay UE, the target gNB-DU and gNB-
CU, if the U2N Relay UE is in RRC_CONNECTED state. The gNB-CU sends an RRCReconfiguration message
to the target U2N Relay UE. If the target Relay UE is in RRC_IDLE/INACTIVE state, this step is skipped and
the configuration to the target U2N Relay UE is performed in Step 10.
4. gNB-CU sends the UE CONTEXT SETUP REQUEST message for the U2N Remote UE to the target gNB-DU,
which contains the path switch configuration at least.
5. gNB-DU responds with the UE CONTEXT SETUP RESPONSE message to gNB-CU.
6. gNB-CU sends the UE CONTEXT MODIFICATION REQUEST message by including the
RRCReconfiguration message to the source gNB-DU. The contents in the RRCReconfiguration message may
include at least path switch configuration, PC5 Relay RLC channel configuration for relaying traffic, bearer
mapping configuration and the associated radio bearer(s).
7. The source gNB-DU sends the RRCReconfiguration message to the U2N Remote UE. The U2N Remote UE
stops UP and CP transmission over Uu after reception of RRCReconfiguration message from the gNB.
8. The source gNB-DU sends the UE CONTEXT MODIFICATION RESPONSE message to the gNB-CU.9. The U2N Remote UE establishes PC5 connection with target U2N Relay UE.
10. The U2N Remote UE completes the path switch procedure by sending the RRCReconfigurationComplete
message to the target gNB-DU via the target U2N Relay UE. In case the U2N relay UE is in RRC_IDLE/
INACTIVE state, when the U2N relay UE receives the RRCReconfigurationComplete message, the reception of
the RRCReconfigurationComplete message will first trigger RRC setup/resume procedure for the U2N relay UE
to enter RRC_CONNECTED state.
11. The target gNB-DU sends the UL RRC MESSAGE TRANSFER message to gNB-CU by including the
RRCReconfigurationComplete message.
12. The gNB-CU sends an UE CONTEXT RELEASE COMMAND message to the source gNB-DU.
13. The source gNB-DU releases the UE context and responds the gNB-CU with an UE CONTEXT RELEASE
COMPLETE message.",108.png
Figure 8.19.4.2-1: U2N Remote UE Direct-to-indirect Path Switch without gNB-DU change procedure,"1.The Uu measurement configuration and measurement report signalling is performed between U2N Remote UE
and gNB-CU to evaluate both relay link measurement and Uu link measurement. The U2N Remote UE may
report one or multiple candidate U2N Relay UE(s) and Uu measurement results after it measures/discovers the
candidate U2N Relay UE(s).
ETSI
3GPP TS 38.401 version 17.6.0 Release 17
 118
 ETSI TS 138 401 V17.6.0 (2023-10)
2. The gNB-CU decides to switch the U2N Remote UE to a target U2N Relay UE under the same gNB-DU.
3.The reconfiguration to target U2N Relay UE is performed among U2N Relay UE, gNB-DU and gNB-CU if U2N
Relay UE is in RRC_CONNECTED state. The gNB-CU sends an RRCReconfiguration message to the target
U2N Relay UE. If the target Relay UE is in RRC_IDLE/INACTIVE state, this step is skipped and the
configuration to the target U2N Relay UE is performed in Step 9.
4. gNB-CU sends the UE CONTEXT MODIFICATION REQUEST message for the U2N Remote UE to gNB-DU,
which contains the path switch configuration at least. The F1-U packets of the U2N Remote UE can be
continuously transmitted via previous tunnels if there is no tunnel update in this step.
5. gNB-DU responds with the UE CONTEXT MODIFICATION RESPONSE message to gNB-CU.
6. gNB-CU sends the DL RRC MESSAGE TRANSFER message by including the RRCReconfiguration message
to gNB-DU. The contents in the RRCReconfiguration message may include at least path switch configuration,
PC5 Relay RLC channel configuration for relaying traffic, bearer mapping configuration and the associated radio
bearer(s).
7. gNB-DU sends the RRCReconfiguration message to the U2N Remote UE. The U2N Remote UE stops UP and
CP transmission over Uu after reception of RRCReconfiguration message from the gNB.
8. The U2N Remote UE establishes PC5 connection with target U2N Relay UE.
9.The U2N Remote UE completes the path switch procedure by sending the RRCReconfigurationComplete
message to the gNB-DU via the target U2N Relay UE. In case the U2N Relay UE is in RRC_IDLE/INACTIVE
state when receiving the RRCReconfigurationComplete message, the reception of the
RRCReconfigurationComplete message will first trigger RRC setup/resume procedure for the U2N relay UE to
enter RRC_CONNECTED state.
10. The gNB-DU sends the UL RRC MESSAGE TRANSFER message to gNB-CU by including the
RRCReconfigurationComplete message.",109.png
Figure 11.1-1: Managing multiple TNLAs for Xn-C.,"1. The NG-RAN node1 establishes the first TNLA with the NG-RAN node2 using a configured TNL address.
NOTE:
The NG-RAN node1 may use different source and/or destination IP end point(s) if the TNL establishment
towards one IP end point fails. How the NG-RAN node1 gets the remote IP end point(s) and its own IP
address are outside the scope of this specification.
2-3. Once the TNLA has been established, the NG-RAN node1 initiates the Xn Setup procedure to exchange
application level configuration data
4-6. The NG-RAN node2 may add additional TNL Endpoint(s) to be used for Xn-C signalling between the NG-
RAN node1 and the NG-RAN node2 pair using the NG-RAN node Configuration Update procedure. NG-RAN
node Configuration Update procedure also allows the NG-RAN node2 to request the NG-RAN node1 to modify
or release TNLA(s).
7-9. The NG-RAN node1 may add additional TNL Endpoint(s) to be used for Xn-C signalling between the NG-
RAN node1 and the NG-RAN node2 pair using the NG-RAN node Configuration Update procedure. NG-RAN
node Configuration Update procedure also allows the NG-RAN node1 to request the NG-RAN node2 to modify
or release TNLA(s).
The XnAP UE TNLA binding is a binding between a XnAP UE association and a specific TNL association for a given
UE. After the XnAP UE TNLA binding is created, the NG-RAN node1 or the NG-RAN node2 can update the UE TNLA
binding by sending the first available XnAP message for the UE to the peer NG-RAN node via a different TNLA. The
peer NG-RAN node shall update the XnAP UE TNLA binding with the new TNLA.",110.png